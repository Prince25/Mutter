(this.webpackJsonpruntime_terror=this.webpackJsonpruntime_terror||[]).push([[0],{350:function(e,t,a){e.exports=a(588)},355:function(e,t,a){},588:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(72),s=a.n(i),o=(a(355),a(18)),c=a(19),l=a(20),u=a(21),d=a(22),m=a(81),p=a(56),h=a(28),f=a(338),E=a(601),g=a(309),v=a.n(g),b=a(314),y=a(590),_=a(609),P=a(611),S=a(337),O=a(612),k=a(603),R=a(613),C=a(600),I=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={isOpen:!1},a.handleOpen=function(){a.setState({isOpen:!0}),a.timeout=setTimeout((function(){a.setState({isOpen:!1})}),1500)},a.handleClose=function(){a.setState({isOpen:!1}),clearTimeout(a.timeout)},a.makePost=function(){var e=a.props.create_url;window.location.href=e},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"playSong",value:function(){var e=this.props,t=e._token,a=e.url,r=e.uri,n=e.deviceid,i=e.type,s=e.account_type;"premium"===s?("track"===i&&fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{authorization:"Bearer ".concat(t)},query:{device_id:n},body:JSON.stringify({uris:[r]})}),"album"!==i&&"artist"!==i&&"playlist"!==i||fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{authorization:"Bearer ".concat(t)},query:{device_id:n},body:JSON.stringify({context_uri:r})})):"free"===s&&window.open(a,"_blank noreferrer noopener")}},{key:"render",value:function(){var e=this,t=this.props,a=t.title,r=t.artist,i=t.album,s=t.art_url,o=t.type,c=t.account_type,l=t.player_connected,u="premium"!==c||l?n.a.createElement(y.a,{fluid:!0,positive:!0,onClick:function(){return e.playSong()}},"Listen!"):n.a.createElement(_.a,{trigger:n.a.createElement(y.a,{fluid:!0,basic:!0,color:"green"},"Listen!"),content:"Please launch Web Player first!",on:"click",open:this.state.isOpen,onClose:this.handleClose,onOpen:this.handleOpen,position:"bottom center"});return n.a.createElement(P.a,{centered:!0,raised:!0},n.a.createElement(P.a.Content,null,"track"===o?n.a.createElement(_.a,{content:"Create a post",position:"top center",trigger:n.a.createElement(y.a,{floated:"right",icon:"plus",onClick:this.makePost})}):null,n.a.createElement(P.a.Header,null,a),n.a.createElement(P.a.Meta,null,i+" - "+r),n.a.createElement(S.a,{src:s})),n.a.createElement(P.a.Content,{extra:!0},u))}}]),t}(r.Component),A=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.song_info;if(Array.isArray(e)){var t=e.map((function(e,t){return n.a.createElement(b.a.Column,{stretched:!0,key:t},n.a.createElement(I,{title:e.title,artist:e.artist,album:e.album,art_url:e.art_url,url:e.url,create_url:e.create_url,_token:e._token,uri:e.uri,deviceid:e.deviceid,type:e.type,account_type:e.account_type,player_connected:e.player_connected}))})),a=Array(Math.ceil(e.length/5)).fill().map((function(e,a){return n.a.createElement(b.a.Row,{key:a},t.slice(5*a,5*a+5))}));return n.a.createElement(b.a,{columns:"equal"},a)}return null}}]),t}(r.Component),j=function e(t,a,r,n,i,s,c,l,u,d,m,p){Object(o.a)(this,e),this.title=t,this.artist=a,this.album=r,this.art_url=n,this.url=i,this.create_url=s,this._token=c,this.uri=l,this.deviceid=u,this.type=d,this.account_type=m,this.player_connected=p},T=A,w=a(75),F=a(218),U=a.n(F);a(462),a(464);U.a.initializeApp({apiKey:"AIzaSyBMD75FP14e3VvxTRllOrc26K9vds7WHBs",authDomain:"runtime-terror-web.firebaseapp.com",databaseURL:"https://runtime-terror-web.firebaseio.com",projectId:"runtime-terror-web",storageBucket:"runtime-terror-web.appspot.com",messagingSenderId:"714361214200",appId:"1:714361214200:web:81690bccecf7b7ce18570d"});var N=U.a,D=function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(t).update({friends_pending:i.FieldValue.arrayRemove(e)}),i.collection("users").doc(t).update({friends:i.FieldValue.arrayUnion(e)}),i.collection("users").doc(e).update({friends:i.FieldValue.arrayUnion(t)}).then((function(){a({type:"ACCEPT_FRIEND",friend_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"ACCEPT_FRIEND_ERROR",err:e})}))}},L=function(e){function t(){var e;Object(o.a)(this,t);var a=(e=Object(l.a)(this,Object(u.a)(t).call(this))).getHashParams().access_token,r=new URLSearchParams(window.location.search).get("error");return e.state={token:a||"",error:r||""},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,r=window.location.hash.substring(1);for(e=a.exec(r);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(r);return t}},{key:"componentDidMount",value:function(){this.state.error||this.handleToken()}},{key:"handleToken",value:function(){var e=this;this.props.auth&&!this.props.auth.isEmpty&&""!==this.state.token&&this.props.updateToken(this.props.auth.uid,this.state.token,(function(){return e.props.history.push("/discover")}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"fullsize_div"},this.state.error?n.a.createElement(R.a,{as:"h2",icon:!0,textAlign:"center"},n.a.createElement(C.a,{hidden:!0}),n.a.createElement(C.a,{hidden:!0}),n.a.createElement(C.a,{hidden:!0}),n.a.createElement(w.a,{name:"exclamation triangle"}),"An access error occured"):n.a.createElement(E.a,{active:!0,size:"massive"},"Redirecting..."))}}]),t}(r.Component);var x=Object(h.b)((function(e){return{auth:e.firebase.auth}}),(function(e){return{updateToken:function(t,a,r){return e(function(e,t,a){return function(r,n,i){i.getFirebase;(0,i.getFirestore)().collection("users").doc(e).update({spotify_token:t}).then((function(){r({type:"SPOTIFY_TOKEN",uId:e})})).catch((function(e){r({type:"SPOTIFY_TOKEN_ERROR",err:e})})),a()}}(t,a,r))}}}))(L),M=a(316),z=a.n(M),B=function(e){var t=!1;return{promise:new Promise((function(a,r){e.then((function(e){t?r({isCancelled:!0}):a(e)})),e.catch((function(e){r(t?{isCancelled:!0}:e)}))})),cancel:function(){t=!0}}},G=a(317),q=a.n(G),V=new z.a,H="https://accounts.spotify.com/authorize?client_id="+Object({NODE_ENV:"production",PUBLIC_URL:"/Mutter",REACT_APP_APP_ID:"1:714361214200:web:81690bccecf7b7ce18570d",REACT_APP_AUTH_DOMAIN:"runtime-terror-web.firebaseapp.com",REACT_APP_DATABASE_URL:"https://runtime-terror-web.firebaseio.com",REACT_APP_FIREBASE_API_KEY:"AIzaSyBMD75FP14e3VvxTRllOrc26K9vds7WHBs",REACT_APP_MESSAGING_SENDER_ID:"714361214200",REACT_APP_PROJECT_ID:"runtime-terror-web",REACT_APP_SPOTIFY_CLIENT_ID:"3a54934c90894909959dd11243291615",REACT_APP_STORAGE_BUCKET:"runtime-terror-web.appspot.com"}).REACT_APP_SPOTIFY_CLIENT+"&redirect_uri="+encodeURIComponent("https://princes25.github.io/Mutter/tokenHandler")+"&scope="+encodeURIComponent(["user-read-private","user-read-email","user-read-playback-state","app-remote-control","user-read-recently-played","user-top-read","user-modify-playback-state","user-read-currently-playing","streaming"].join(" "))+"&response_type=token",K="https://princes25.github.io/Mutter",Y=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleSearchChange=function(t,a){var r=a.value;e.setState({value:r}),setTimeout((function(){if(e.state.value.length<1)return e.setState({value:"",results:[]});switch(e.state.searchButton){case"songs":e.searchTracks(r),e.setState({results:e.state.searchedTracks!==[]&&e.state.searchedTracks.tracks&&e.state.searchedTracks.tracks.items?e.state.searchedTracks.tracks.items:[]});break;case"artists":e.searchArtists(r),e.setState({results:e.state.searchedArtists!==[]&&e.state.searchedArtists.artists&&e.state.searchedArtists.artists.items?e.state.searchedArtists.artists.items:[]});break;case"albums":e.searchAlbums(r),e.setState({results:e.state.searchedAlbums!==[]&&e.state.searchedAlbums.albums&&e.state.searchedAlbums.albums.items?e.state.searchedAlbums.albums.items:[]});break;case"playlists":e.searchPlaylists(r),e.setState({results:e.state.searchedPlaylists!==[]&&e.state.searchedPlaylists.playlists&&e.state.searchedPlaylists.playlists.items?e.state.searchedPlaylists.playlists.items:[]});break;default:e.setState({results:[]})}}),20)},e.onPrevClick=function(){e.state.player_connected&&e.player.previousTrack()},e.onPlayClick=function(){e.state.player_connected&&e.player.togglePlay()},e.onNextClick=function(){e.state.player_connected&&e.player.nextTrack()},e.createPost=function(){void 0===e.state.trackUrl?window.location.href=K+"/createpost/#SongName="+e.state.trackName:window.location.href=K+"/createpost/#SongName="+e.state.trackName+"&SongUrl="+e.state.trackUrl},e.state={loggedIn:!1,searchButton:"songs",searchedTracks:[],searchedArtists:[],searchedAlbums:[],searchedPlaylists:[],value:"",results:[],newReleases:[],recentlyPlayed:[],topTracks:[],_token:"",deviceId:"",error:"",trackName:void 0,trackUrl:void 0,artistName:void 0,albumName:void 0,playing:!1,position:0,duration:1,albumArt:"",player_connected:!1,account_type:"Not Logged In. Click to authenticate!",accountTypePromise:null,newReleasesPromise:null,recentSongsPromise:null,topTracksPromise:null,searchTracksPromise:null,searchArtistsPromise:null,searchAlbumsPromise:null,searchPlaylistsPromise:null,initializeOnceMounted:void 0},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onRouteChange",value:function(e){this.state.player_connected&&this.player.disconnect()}},{key:"initialize",value:function(){if(this.state.loggedIn){clearInterval(this.initializeOnceMounted);var e=this.state._token,t=V.getAccessToken();e?V.setAccessToken(e):t&&V.setAccessToken(t),this.getAccountType(),this.getNewReleases(),this.getRecentSongs(),this.getTopTracks(),this.playerCheckInterval=null,this.props.history.listen(this.onRouteChange.bind(this))}}},{key:"componentDidMount",value:function(){var e=this;this.initializeOnceMounted=setInterval((function(){return e.initialize()}),20)}},{key:"componentWillUnmount",value:function(){for(var e=this.state,t=[e.accountTypePromise,e.newReleasesPromise,e.recentSongsPromise,e.topTracksPromise,e.searchTracksPromise,e.searchArtistsPromise,e.searchAlbumsPromise,e.searchPlaylistsPromise],a=0;a<t.length;a++)t[a]&&t[a].cancel();void 0!==this.initializeOnceMounted&&clearInterval(this.initializeOnceMounted)}},{key:"getAccountType",value:function(){var e=this,t=B(V.getMe());this.setState({accountTypePromise:t},(function(){t.promise.then((function(t){var a="premium"===t.product?"premium":"free";return e.setState({account_type:a}),t}),(function(e){console.log("Something went wrong!",e),401===e.status&&window.confirm("Token Expired! Please re-login to Spotify!")&&(window.location.href=H)}))}))}},{key:"getNewReleases",value:function(){var e=this,t=B(V.getNewReleases({limit:5,offset:0,country:"US"}));this.setState({newReleasesPromise:t},(function(){t.promise.then((function(t){return e.setState({newReleases:t.albums.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"getRecentSongs",value:function(){var e=this,t=B(V.getMyRecentlyPlayedTracks({limit:5}));this.setState({recentSongsPromise:t},(function(){t.promise.then((function(t){return e.setState({recentlyPlayed:t.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"getTopTracks",value:function(){var e=this,t=B(V.getMyTopTracks({limit:5}));this.setState({topTracksPromise:t},(function(){t.promise.then((function(t){return e.setState({topTracks:t.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"searchTracks",value:function(e){var t=this,a=B(V.searchTracks(e));this.setState({searchTracksPromise:a}),a.promise.then((function(e){return t.setState({searchedTracks:e}),e}),(function(e){console.error(e)}))}},{key:"searchAlbums",value:function(e){var t=this,a=B(V.searchAlbums(e));this.setState({searchAlbumsPromise:a}),a.promise.then((function(e){return t.setState({searchedAlbums:e}),e}),(function(e){console.error(e)}))}},{key:"searchArtists",value:function(e){var t=this,a=B(V.searchArtists(e));this.setState({searchArtistsPromise:a}),a.promise.then((function(e){return t.setState({searchedArtists:e}),e}),(function(e){console.error(e)}))}},{key:"searchPlaylists",value:function(e){var t=this,a=B(V.searchPlaylists(e));this.setState({searchPlaylistsPromise:a}),a.promise.then((function(e){return t.setState({searchedPlaylists:e}),e}),(function(e){console.error(e)}))}},{key:"checkForPlayer",value:function(){var e=this.state._token;if(null!==window.Spotify){clearInterval(this.playerCheckInterval),this.player=new window.Spotify.Player({name:"Runtime Terror's Spotify Player",getOAuthToken:function(t){t(e)}}),this.createEventHandlers(),this.player.connect();this.setState({player_connected:!0})}}},{key:"checkForPlayer_driver",value:function(){var e=this;this.playerCheckInterval=setInterval((function(){return e.checkForPlayer()}),10)}},{key:"createEventHandlers",value:function(){var e=this;this.player.on("initialization_error",(function(e){console.error(e)})),this.player.on("authentication_error",(function(t){console.error(t),e.setState({loggedIn:!1})})),this.player.on("account_error",(function(e){console.error(e)})),this.player.on("playback_error",(function(e){console.error(e)})),this.player.on("player_state_changed",(function(t){return e.onStateChanged(t)})),this.player.on("ready",(function(t){var a;return v.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:a=t.device_id,console.log("Let the music play on!"),e.setState({deviceId:a}),e.transferPlaybackHere();case 4:case"end":return r.stop()}}))}))}},{key:"onStateChanged",value:function(e){if(null!==e){var t=e.track_window,a=t.current_track,r=t.position,n=t.duration,i=a.name,s="https://open.spotify.com/track/"+a.id,o=a.album.name,c=a.artists.map((function(e){return e.name})).join(", "),l=!e.paused,u=a.album.images[0].url;this.setState({position:r,duration:n,trackName:i,trackUrl:s,albumName:o,artistName:c,playing:l,albumArt:u})}}},{key:"transferPlaybackHere",value:function(){var e=this.state,t=e.deviceId,a=e._token;fetch("https://api.spotify.com/v1/me/player",{method:"PUT",headers:{authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({device_ids:[t],play:!1})})}},{key:"render",value:function(){var e,t=this,a=this.state,r=a.value,i=a.results,s=a.recentlyPlayed,o=a.topTracks,c=a.newReleases,l=a.trackName,u=a.artistName,d=a.albumName,m=a.albumArt,p=a.playing,h=a._token,E=a.deviceId,g=a.account_type,v=a.player_connected,k=[],R=[],C=[],I=[];if("undefined"!==i)for(e=0;e<Math.min(i.length,5);e++){var A=i[e].name,T="track"===i[e].type?i[e].artists[0].name:"playlist"===i[e].type?i[e].owner.display_name:"album"===i[e].type?i[e].artists[0].name:"",w="track"===i[e].type?i[e].album.name:"",F="artist"===i[e].type||"playlist"===i[e].type||"album"===i[e].type?i[e].images.length>0?i[e].images[0].url:"":i[e].album.images[0].url,U=i[e].external_urls.spotify,N=h,D=i[e].uri,L=E,x=i[e].type,M=K+"/createpost/#SongName="+A+"&SongUrl="+U;k.push(new j(A,T,w,F,U,M,N,D,L,x,g,v))}if("undefined"!==s)for(e=0;e<Math.min(s.length,5);e++){var z=s[e].track.name,B=s[e].track.artists[0].name,G=s[e].track.album.name,V=s[e].track.album.images[0].url,Y=s[e].track.external_urls.spotify,W=h,Q=s[e].track.uri,$=E,X=s[e].track.type,Z=K+"/createpost/#SongName="+z+"&SongUrl="+Y;C.push(new j(z,B,G,V,Y,Z,W,Q,$,X,g,v))}if("undefined"!==o)for(e=0;e<Math.min(o.length,5);e++){var ee=o[e].name,te=o[e].artists[0].name,ae=o[e].album.name,re=o[e].album.images[0].url,ne=o[e].external_urls.spotify,ie=h,se=o[e].uri,oe=E,ce=o[e].type,le=K+"/createpost/#SongName="+ee+"&SongUrl="+ne;I.push(new j(ee,te,ae,re,ne,le,ie,se,oe,ce,g,v))}if("undefined"!==c)for(e=0;e<Math.min(c.length,5);e++){var ue=c[e].name,de=c[e].artists[0].name,me=c[e].images[0].url,pe=c[e].external_urls.spotify,he=h,fe=c[e].uri,Ee=E,ge=c[e].type,ve=K+"/createpost/#SongName="+ue+"&SongUrl="+pe;R.push(new j(ue,de,"",me,pe,ve,he,fe,Ee,ge,g,v))}var be=n.a.createElement(f.a.Item,null,n.a.createElement(b.a,null,n.a.createElement(y.a,{key:0,inverted:!0,icon:"backward",onClick:this.onPrevClick}),n.a.createElement(y.a,{key:1,inverted:!0,icon:p?"pause":"play",onClick:this.onPlayClick}),n.a.createElement(y.a,{key:2,inverted:!0,icon:"forward",onClick:this.onNextClick}),n.a.createElement(_.a,{key:3,trigger:n.a.createElement(f.a.Item,null,l),position:"bottom center"},n.a.createElement(_.a.Content,null,n.a.createElement(P.a,{centered:!0,raised:!0},n.a.createElement(P.a.Content,null,n.a.createElement(P.a.Header,null,l),n.a.createElement(P.a.Meta,null,d+" - "+u),n.a.createElement(S.a,{src:m}))))),n.a.createElement(_.a,{key:4,trigger:n.a.createElement(y.a,{inverted:!0,icon:"plus",onClick:this.createPost}),position:"bottom center"},n.a.createElement(_.a.Content,null,"Create post"))));return n.a.createElement("div",{className:"Discover"},n.a.createElement(f.a,{inverted:!0},"premium"===this.state.account_type?!this.state.loggedIn||this.state.player_connected&&void 0!==l?be:n.a.createElement(f.a.Item,{onClick:function(){return t.checkForPlayer_driver()}},"Launch Web Player"):null,n.a.createElement(f.a.Item,{position:"right",onClick:function(){return console.log()}},n.a.createElement(b.a,{centered:!0},n.a.createElement(O.a,{fluid:!0,showNoResults:!1,size:"large",onSearchChange:q.a.debounce(this.handleSearchChange,20),value:r,placeholder:"Search for "+this.state.searchButton+"..."}),n.a.createElement(y.a.Group,{labeled:!0},n.a.createElement(y.a,{positive:"songs"===this.state.searchButton,secondary:!0,content:"Song",onClick:function(){return t.setState({value:"",results:[],searchButton:"songs"})}}),n.a.createElement(y.a,{positive:"artists"===this.state.searchButton,secondary:!0,content:"Artist",onClick:function(){return t.setState({value:"",results:[],searchButton:"artists"})}}),n.a.createElement(y.a,{positive:"albums"===this.state.searchButton,secondary:!0,content:"Album",onClick:function(){return t.setState({value:"",results:[],searchButton:"albums"})}}),n.a.createElement(y.a,{positive:"playlists"===this.state.searchButton,secondary:!0,content:"Playlist",onClick:function(){return t.setState({value:"",results:[],searchButton:"playlists"})}})))),this.state.loggedIn?n.a.createElement(f.a.Item,{href:H},"Spotify Status: ",n.a.createElement("p",{style:{color:"premium"===this.state.account_type?"gold":"green",whiteSpace:"pre"}}," ",this.state.account_type.charAt(0).toUpperCase()+this.state.account_type.slice(1)," ")):n.a.createElement(f.a.Item,{href:H},"Sign In To Spotify")),this.state.loggedIn||""!==this.state._token?null:n.a.createElement("p",{align:"center",style:{color:"#139bd1",fontSize:"26px"}},"Welcome! ",n.a.createElement("br",null)," Please log into Spotify to get started."),0!==k.length?n.a.createElement(J,{title:"Search Results",song_info:k,expand:this.expandSection}):null,0!==C.length?n.a.createElement(J,{title:"Recent Songs",song_info:C}):null,0!==I.length?n.a.createElement(J,{title:"Your Top Picks",song_info:I}):null,0!==R.length?n.a.createElement(J,{title:"New Releases",song_info:R}):null,n.a.createElement("br",null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.profile.isLoaded&&e.profile.spotify_token&&t._token!==e.profile.spotify_token?{_token:e.profile.spotify_token,loggedIn:!0}:null}}]),t}(r.Component),J=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.song_info;return n.a.createElement("div",null,n.a.createElement("br",null),n.a.createElement(k.a,{fluid:!0},n.a.createElement(R.a,{as:"h2",textAlign:"center"},t),n.a.createElement(C.a,null),n.a.createElement(T,{song_info:a}),n.a.createElement(C.a,{hidden:!0}),n.a.createElement(C.a,{hidden:!0})))}}]),t}(r.Component),W=Object(h.b)((function(e){return{profile:e.firebase.profile}}))(Y),Q=a(315),$=a(313),X=a(222),Z=a(31),ee=a(606),te=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={email:"",password:"",name:""},a.submit=function(){a.props.signUp(a.state)},a.change=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.authError;return n.a.createElement(ee.a,{onSubmit:this.submit},n.a.createElement(ee.a.Field,null,n.a.createElement(ee.a.Input,{label:"Email",id:"email",placeholder:"Enter your email",onChange:this.change})),n.a.createElement(ee.a.Field,null,n.a.createElement(ee.a.Input,{label:"Password",id:"password",placeholder:"Enter your password",type:"password",onChange:this.change})),n.a.createElement(ee.a.Field,null,n.a.createElement(ee.a.Input,{label:"Name",id:"name",placeholder:"Enter your name",onChange:this.change})),e?n.a.createElement("p",{style:{color:"red"}},e):null,n.a.createElement(ee.a.Field,{control:y.a},n.a.createElement($.a,null,n.a.createElement(w.a,{name:"headphones"}),"Sign Up")))}}]),t}(r.Component),ae=Object(h.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signUp:function(t){return e(function(e){return function(t,a,r){var n=(0,r.getFirestore)();N.auth().createUserWithEmailAndPassword(e.email,e.password).then((function(t){n.collection("users").doc(t.user.uid).set({name:e.name,friends:[],friends_pending:[],privacy:"public",spotify_token:"",imageUrl:"https://firebasestorage.googleapis.com/v0/b/runtime-terror-1d144.appspot.com/o/profile_images%2Fdefault_pic.png?alt=media&token=74c12ae4-d4ca-4ad2-af25-c38c2206ee43"})})).then((function(){t({type:"SIGNUP_SUCCESS"})})).catch((function(e){t({type:"SIGNUP_ERROR",err:e})}))}}(t))}}}))(te),re=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={email:"",password:""},a.submit=function(){a.props.signIn(a.state)},a.change=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.authError;return n.a.createElement(ee.a,{onSubmit:this.submit},n.a.createElement(ee.a.Field,null,n.a.createElement(ee.a.Input,{label:"Email",id:"email",placeholder:"Enter your email",onChange:this.change})),n.a.createElement(ee.a.Field,null,n.a.createElement(ee.a.Input,{label:"Password",id:"password",placeholder:"Enter your password",type:"password",onChange:this.change})),e?n.a.createElement("p",{style:{color:"red"}},e):null,n.a.createElement(ee.a.Field,{control:y.a,fluid:!0},n.a.createElement($.a,null,n.a.createElement(w.a,{name:"headphones"}),"Sign In")))}}]),t}(r.Component),ne=Object(h.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signIn:function(t){return e((a=t,function(e,t){N.auth().signInWithEmailAndPassword(a.email,a.password).then((function(){e({type:"LOGIN_SUCCESS"})})).catch((function(t){e({type:"LOGIN_ERROR",err:t})}))}));var a}}}))(re),ie=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={signing_up:!1},a.sign_up=function(e){a.setState({signing_up:e})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.signing_up?n.a.createElement(ae,null):n.a.createElement(ne,null);return n.a.createElement("div",null,n.a.createElement(y.a.Group,null,n.a.createElement(y.a,{color:"yellow",onClick:function(){e.sign_up(!0)}},n.a.createElement($.a,null,n.a.createElement(w.a,{name:"plus"}),"Sign Up")),n.a.createElement(y.a.Or,null),n.a.createElement(y.a,{color:"yellow",onClick:function(){e.sign_up(!1)}},n.a.createElement($.a,null,n.a.createElement(w.a,{name:"music"}),"Sign In"))),n.a.createElement(X.a,null,t))}}]),t}(r.Component),se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.auth;return e.isLoaded&&e.uid?n.a.createElement(m.a,{to:"/"}):n.a.createElement(b.a,{padded:!0,centered:!0},n.a.createElement(S.a,{src:"img/silhouette_2.png"}),n.a.createElement(Q.a,null," ",n.a.createElement(ie,null)," "))}}]),t}(r.Component),oe=Object(h.b)((function(e){return{auth:e.firebase.auth}}))(se),ce=a(616),le=a(40),ue=a(60),de=a(323),me=a.n(de),pe=a(608),he=function(e){var t=e.post,a=e.users,r=a&&t?a.filter((function(e){return e.id===t.authorId}))[0]:null,i=n.a.createElement("div",null,n.a.createElement(p.b,{to:"/profile/"+t.authorId}," ",t.author," "),"rated song ",n.a.createElement("b",null,n.a.createElement("a",{href:t.url?t.url:null}," ",t.song," ")),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=1?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=2?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=3?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=4?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=5?"star_checked":"")}));return r&&t?n.a.createElement("div",null,n.a.createElement(pe.a,{size:"large"},n.a.createElement(pe.a.Event,{image:r.imageUrl,date:me()(t.createdAt.toDate()).format("LLLL"),summary:i,extraText:t.comment})),n.a.createElement(C.a,null)):null},fe=function(e){var t=e.posts,a=e.users;return n.a.createElement("div",null,t&&0===t.length?n.a.createElement("h3",null,"No Posts Yet!"):null,t&&t.map((function(e){return n.a.createElement(he,{key:e.id,post:e,users:a})})))},Ee=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={friendsPosts:null,explorePosts:null,users:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{menuItem:"Friends",render:function(){return n.a.createElement(ce.a.Pane,null,n.a.createElement(fe,{posts:e.state.friendsPosts,users:e.state.users}))}},{menuItem:"Explore",render:function(){return n.a.createElement(ce.a.Pane,null,n.a.createElement(fe,{posts:e.state.explorePosts,users:e.state.users}))}}];return n.a.createElement("div",null,n.a.createElement(C.a,{hidden:!0}),n.a.createElement(ce.a,{panes:t}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={};return e.explorePosts!==t.explorePosts&&Object.assign(a,{explorePosts:e.explorePosts}),void 0!==e.friendsPosts&&e.friendsPosts!==t.friendsPosts&&Object.assign(a,{friendsPosts:e.friendsPosts}),void 0!==e.users&&e.users!==t.users&&Object.assign(a,{users:e.users}),0!==a.length?a:null}}]),t}(r.Component),ge=Object(le.d)(Object(h.b)((function(e){var t=["0"];for(var a in e.firestore.ordered.users)e.firebase.auth.uid===e.firestore.ordered.users[a].id&&(t=e.firestore.ordered.users[a].friends);if(null!=e.firestore.ordered.friendsPosts)var r=e.firestore.ordered.friendsPosts.sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds}));if(e.firestore.ordered.publicPosts)var n=e.firestore.ordered.publicPosts.sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds}));return{explorePosts:n,friendsPosts:r,auth:e.firebase.auth,users:e.firestore.ordered.users,currentFriendsList:t}})),Object(ue.firestoreConnect)((function(e){return[{collection:"users"},{collection:"posts",storeAs:"friendsPosts",where:["authorId","in",null===e.currentFriendsList||0===e.currentFriendsList.length?["0"]:e.currentFriendsList]},{collection:"posts",storeAs:"publicPosts",where:["privacy","==","public"]}]})))(Ee),ve=a(128),be=a(607),ye=a(109),_e=a(98),Pe=a(604),Se=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).handleChange=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a.handleRating=function(e,t){var r=t.value;a.setState({rating:r})},a.handleSubmit=function(e){e.preventDefault(),a.state.rating?(a.props.createPost({song:a.state.song,comment:a.state.comment,rating:a.state.rating,privacy:a.state.privacy,url:a.state.url}),a.props.history.push("/")):a.setState({error:"Rating is required!"})},a.toggle=function(){a.setState({privacy:"private"===a.state.privacy?"public":"private"})};var r=a.getHashParams(),n=r.SongName,i=r.SongUrl;return a.state={song:n||"",comment:"",rating:"",url:i||"",privacy:e.profile.privacy,error:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,r=window.location.hash.substring(1);for(e=a.exec(r);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(r);return t}},{key:"render",value:function(){return n.a.createElement(k.a,{text:!0},n.a.createElement(C.a,{hidden:!0}),n.a.createElement(R.a,{as:"h2"},"Create Post"),n.a.createElement(ee.a,{onSubmit:this.handleSubmit},n.a.createElement(ee.a.Group,{widths:"equal"},n.a.createElement(ee.a.Input,{id:"song",label:"Song",name:"Song",required:!this.state.song,readOnly:!!this.state.url,placeholder:this.state.song,onChange:this.handleChange}),n.a.createElement(ee.a.Input,{id:"url",label:"URL",name:"URL",readOnly:!0,disabled:!this.state.url,placeholder:this.state.url,onChange:this.handleChange})),n.a.createElement(ee.a.Field,{control:Pe.a,toggle:!0,label:"private"===this.state.privacy?"This post will be Private":"This post will be Public",defaultChecked:"private"===this.state.privacy,onClick:this.toggle}),n.a.createElement(ee.a.Dropdown,{id:"rating",label:"Rating",placeholder:"Select",required:!0,inline:!0,error:this.state.error,onChange:this.handleRating,options:[{text:"1",value:1},{text:"2",value:2},{text:"3",value:3},{text:"4",value:4},{text:"5",value:5}]}),n.a.createElement(ee.a.TextArea,{id:"comment",label:"Comment",name:"Comment",onChange:this.handleChange}),n.a.createElement(ee.a.Button,{type:"submit",color:"green"},"Create Post")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.profile&&e.profile.isLoaded&&void 0!==e.profile.privacy&&void 0===t.privacy?{privacy:e.profile.privacy}:null}}]),t}(r.Component),Oe=Object(h.b)((function(e){return{profile:e.firebase.profile}}),(function(e){return{createPost:function(t){return e((a=t,function(e,t,r){r.getFirebase;var n=(0,r.getFirestore)(),i=t().firebase.profile,s=t().firebase.auth.uid;n.collection("posts").add(Object(_e.a)({},a,{author:i.name,authorId:s,createdAt:new Date})).then((function(){e({type:"CREATE_POST",post:a})})).catch((function(t){e({type:"CREATE_POST_ERROR",err:t})}))}));var a}}}))(Se),ke=function(e){var t=e.friends,a=e.users;return n.a.createElement("div",null,t&&0===t.length?n.a.createElement("h3",null,"No Friends Yet :("):null,t&&a&&t.map((function(e){var t=a.filter((function(t){return t.id===e}))[0],r=t?n.a.createElement(p.b,{to:"/profile/"+e}," ",t.name," "):null;return n.a.createElement(pe.a,{key:e},n.a.createElement(pe.a.Event,{image:t?t.imageUrl:null,summary:r}),n.a.createElement(C.a,{fitted:!0}))})))},Re=a(221),Ce=a.n(Re),Ie=a(324),Ae=a.n(Ie),je=a(605),Te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).state={image:"",isUploading:!1,progress:0,imageURL:"",open:!1},a.handleUploadStart=function(){a.setState({isUploading:!0,progress:0,imageURL:null,image:null})},a.handleProgress=function(e){return a.setState({progress:e})},a.handleUploadError=function(e){a.setState({isUploading:!1}),console.error(e)},a.handleUploadSuccess=function(e){a.setState({image:e,progress:100,isUploading:!1}),Ce.a.storage().ref("profile_images").child(e).getDownloadURL().then((function(e){a.setState({imageURL:e}),a.props.updateImage(a.uId,e),a.handleModalClose()}))},a.handleModalClose=function(){a.setState({image:"",isUploading:!1,progress:0,imageURL:"",open:!1})},a.uId=e.uId,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.previousImageUrl;return n.a.createElement(be.a,{trigger:n.a.createElement(S.a,{src:t,size:"medium",circular:!0,bordered:!0}),open:this.state.open,onOpen:function(){return e.setState({open:!0})},closeOnDimmerClick:!1,closeOnDocumentClick:!1,size:"small"},n.a.createElement(be.a.Content,null,n.a.createElement(b.a,{divided:!0,stretched:!0,centered:!0},n.a.createElement(b.a.Row,{stretched:!0},n.a.createElement(b.a.Column,{stretched:!0},n.a.createElement(R.a,{as:"h2"},"Current"),n.a.createElement(S.a,{src:t,wrapped:!0,size:"medium",href:t,bordered:!0}))),n.a.createElement(b.a.Row,{stretched:!0},n.a.createElement(b.a.Column,{stretched:!0},n.a.createElement(b.a,{stretched:!0,columns:16},n.a.createElement(b.a.Row,null,n.a.createElement(b.a.Column,{width:6},n.a.createElement(Ae.a,{accept:"image/*",name:"image",filename:this.uId,storageRef:Ce.a.storage().ref("profile_images"),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress})),n.a.createElement(b.a.Column,{width:10},this.state.imageURL?n.a.createElement(je.a,{percent:100,success:!0},"Uploaded"):this.state.isUploading?n.a.createElement(je.a,{percent:this.state.progress,progress:!0,color:"blue"}):null))))))),n.a.createElement(be.a.Actions,null,n.a.createElement(y.a,{color:"red",onClick:function(){e.setState({open:!1})}},"Cancel")))}}]),t}(r.Component),we=Object(h.b)(null,(function(e){return{updateImage:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;(0,n.getFirestore)().collection("users").doc(e).update({imageUrl:t}).then((function(){a({type:"USER_IMAGE",uId:e,imageUrl:t})})).catch((function(e){a({type:"USER_IMAGE_ERROR",err:e})}))}}(t,a))}}}))(Te),Fe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={posts_content:null,friends_content:null,navigate:null,open:!1,name:"",privacy:null,profile:null},a.navigate=function(e){a.setState({navigate:e})},a.handleChange=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){a.handleSubmitPrivacy(e,a.state.privacy)},a.handleSubmitPrivacy=function(e,t){e.preventDefault(),a.props.updateProfile(a.props.auth.uid,{name:a.state.name,privacy:t,profile:a.state.profile}),a.props.history.push("/profile/"+a.props.auth.uid),a.setState({open:!1})},a.togglePrivacy=function(e){var t="private"===a.state.privacy?"public":"private";a.setState({privacy:t}),a.handleSubmitPrivacy(e,t)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.auth,r=t.users,i=t.profile,s=t.match,o=t.curProfilePosts,c=t.currentFriendsList,l=r&&a?r.filter((function(e){return e.id===s.params.id}))[0]:null,u=l?l.imageUrl:null,d=a.uid&&s.params&&a.uid===s.params.id,p=s&&a?n.a.createElement(y.a,{onClick:function(){e.props.addFriend(s.params.id,a.uid)}},"Add Friend"):null;a&&l&&l.friends_pending&&l.friends_pending.includes(a.uid)?p=n.a.createElement(y.a,null,"Friend Request Sent"):a&&l&&l.friends.includes(a.uid)&&s?p=n.a.createElement(y.a,{onClick:function(){e.props.removeFriend(s.params.id,a.uid)}},"Remove Friend"):i&&i.friends_pending&&a&&s&&i.friends_pending.includes(s.params.id)&&(p=n.a.createElement(y.a,{onClick:function(){e.props.acceptFriend(s.params.id,a.uid)}},"Accept Friend Request"));var h=n.a.createElement("div",null," ",n.a.createElement(fe,{posts:o,users:r})," "),f=l?c&&s&&s.params&&s.params.id&&c.includes(s.params.id)||a&&s&&s.params&&s.params.id&&a.uid===s.params.id?n.a.createElement("div",null," ",n.a.createElement(ke,{users:r,friends:l.friends})," "):n.a.createElement("div",null," ",n.a.createElement(ke,{users:r,friends:[]})," "):null,E=[{menuItem:"Posts",render:function(){return n.a.createElement(ce.a.Pane,null,h)}},{menuItem:"Friends",render:function(){return n.a.createElement(ce.a.Pane,null,f)}}];return"/createpost"===this.state.navigate?n.a.createElement("div",null,n.a.createElement(m.a,{to:this.state.navigate}),n.a.createElement(Oe,null)):n.a.createElement("div",null,n.a.createElement(b.a,{centered:!0,padded:"vertically"},n.a.createElement(Q.a,null,n.a.createElement(X.a,null,d?n.a.createElement(we,{uId:a.uid,previousImageUrl:u}):n.a.createElement(S.a,{src:u,size:"medium",circular:!0,bordered:!0}),n.a.createElement("br",null),n.a.createElement(y.a,{as:"div",labelPosition:"left"},n.a.createElement(ve.a,{basic:!0},l?l.name:null),d?n.a.createElement(be.a,{trigger:n.a.createElement(y.a,{compact:!0,icon:"edit"}),open:this.state.open,onOpen:function(){return e.setState({open:!0})},closeOnDimmerClick:!1,closeOnDocumentClick:!1,size:"small"},n.a.createElement(be.a.Content,null,n.a.createElement(ee.a,{onSubmit:this.handleSubmit},n.a.createElement(ee.a.Field,null,n.a.createElement("label",null,"New Name"),n.a.createElement(ee.a.Input,{id:"name",onChange:this.handleChange,placeholder:l?l.name:""})),n.a.createElement(y.a,{type:"submit",color:"green"},"Change name"),n.a.createElement(y.a,{floated:"right",color:"red",onClick:function(){return e.setState({open:!1})}},"Cancel")))):null),d?n.a.createElement("div",null,n.a.createElement(b.a,null,n.a.createElement(b.a.Column,{floated:"left"},n.a.createElement(y.a,{onClick:this.togglePrivacy,basic:!0,size:"small",color:"private"===this.state.privacy?"red":"green"},"private"===this.state.privacy?"Private":"Public")),n.a.createElement(b.a.Column,{floated:"right"},n.a.createElement(y.a,{floated:"right",icon:"plus",onClick:function(){e.navigate("/createpost")}})))):p)),n.a.createElement(Q.a,null," ",n.a.createElement(ye.a,{width:16}," ",n.a.createElement(ce.a,{panes:E})," ")," ")))}},{key:"componentDidUpdate",value:function(){null!=this.state.navigate&&this.navigate(null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={};return(null===t.profile||t.profile.isLoading)&&e.profile&&(void 0!==e.profile.privacy&&Object.assign(a,{privacy:e.profile.privacy,profile:e.profile}),void 0!==e.profile.name&&Object.assign(a,{name:e.profile.name})),a}}]),t}(r.Component),Ue=Object(le.d)(Object(h.b)((function(e){var t=["0"];for(var a in e.firestore.ordered.users)e.firebase.auth.uid===e.firestore.ordered.users[a].id&&(t=e.firestore.ordered.users[a].friends);var r=[];return null!=e.firestore.ordered.curPrivatePosts&&null!=e.firestore.ordered.curPublicPosts?r=e.firestore.ordered.curPrivatePosts.concat(e.firestore.ordered.curPublicPosts).sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds})):null!=e.firestore.ordered.curPublicPosts?r=e.firestore.ordered.publicPosts:null!=e.firestore.ordered.curPrivatePosts&&(r=e.firestore.ordered.curPrivatePosts),{curProfilePosts:r,auth:e.firebase.auth,profile:e.firebase.profile,users:e.firestore.ordered.users,currentFriendsList:t}}),(function(e){return{addFriend:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(e).update({friends_pending:i.FieldValue.arrayUnion(t)}).then((function(){a({type:"SEND_FRIEND_REQUEST",profile_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"SEND_FRIEND_REQUEST_ERROR",err:e})}))}}(t,a))},removeFriend:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(e).update({friends:i.FieldValue.arrayRemove(t)}),i.collection("users").doc(t).update({friends:i.FieldValue.arrayRemove(e)}).then((function(){a({type:"REMOVE_FRIEND",profile_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"REMOVE_FRIEND_ERROR",err:e})}))}}(t,a))},acceptFriend:function(t,a){return e(D(t,a))},updateProfile:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)(),s=t.name,o=t.privacy;i.collection("users").doc(e).update({name:s,privacy:o}).then((function(){a({type:"USER_UPDATE",uId:e,newInfo:t})})).catch((function(e){a({type:"USER_UPDATE_ERROR",err:e})}))}}(t,a))}}})),Object(ue.firestoreConnect)((function(e){return[{collection:"users"},{collection:"posts",storeAs:"curPrivatePosts",where:[["authorId","==",e.match.params.id],["privacy","==",null===e.currentFriendsList||e.match.params.id!==e.auth.uid&&!e.currentFriendsList.includes(e.match.params.id)?"0":"private"]]},{collection:"posts",storeAs:"curPublicPosts",where:[["authorId","==",e.match.params.id],["privacy","==","public"]]}]})))(Fe),Ne=a(610),De=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.users,r=e.profile,i=e.acceptFriend,s=e.rejectFriend,o=r?r.friends_pending:null;return n.a.createElement("div",null,n.a.createElement(k.a,{text:!0},n.a.createElement(C.a,{hidden:!0}),o&&0===o.length?n.a.createElement("h3",null,"No Friends Requests"):null,o&&a&&o.map((function(e){var r=a.filter((function(t){return t.id===e}))[0],o=r?n.a.createElement(p.b,{to:"/profile/"+e}," ",r.name," "):null;return n.a.createElement(Ne.a,{divided:!0,animated:!0,relaxed:!0,verticalAlign:"middle",size:"big",key:e},n.a.createElement(Ne.a.Item,null,n.a.createElement(S.a,{avatar:!0,src:r?r.imageUrl:null}),n.a.createElement(Ne.a.Content,null," ",n.a.createElement(Ne.a.Header,null,o)," "),n.a.createElement(Ne.a.Content,{floated:"right"},n.a.createElement(Ne.a.Description,{as:"a",onClick:function(){return i(e,t.uid)}},n.a.createElement(w.a,{name:"check",color:"green"}),"Accept"),n.a.createElement(Ne.a.Description,{as:"a",onClick:function(){return s(e,t.uid)}},n.a.createElement(w.a,{name:"close",color:"red"}),"Reject"))),n.a.createElement(C.a,null))}))))}}]),t}(r.Component),Le=Object(le.d)(Object(h.b)((function(e){return{auth:e.firebase.auth,profile:e.firebase.profile,users:e.firestore.ordered.users}}),(function(e){return{acceptFriend:function(t,a){return e(D(t,a))},rejectFriend:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(t).update({friends_pending:i.FieldValue.arrayRemove(e)}).then((function(){a({type:"REJECT_FRIEND",friend_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"REJECT_FRIEND_ERROR",err:e})}))}}(t,a))}}})),Object(ue.firestoreConnect)([{collection:"users"}]))(De),xe=a(614),Me=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).LOGIN="LOGIN",a.PROFILE="PROFILE",a.DISCOVER="DISCOVER",a.FEED="FEED",a.REQUESTS="REQUESTS",a.state={redirect_target:null,targets:{FEED:"/",LOGIN:"/login",PROFILE:"/profile/"+a.props.auth.uid,DISCOVER:"/discover",REQUESTS:"/requests"},visible:!1},a.load=function(e){a.setState({redirect_target:e,visible:!1})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.profile,a=t?n.a.createElement(S.a,{circular:!0,centered:!0,size:"mini",src:t.imageUrl,alt:""}):null,r=t?n.a.createElement(S.a,{circular:!0,centered:!0,size:"small",src:t.imageUrl,alt:""}):null,i=t&&t.friends_pending?t.friends_pending.length:0,s=i>0?n.a.createElement(f.a.Item,{onClick:function(){e.load(e.REQUESTS)}},"Friend Requests:",n.a.createElement(ve.a,{color:"teal"},i," ")):null,o=n.a.createElement("div",{className:"fullsize_div",id:"sidebar_2"},n.a.createElement(f.a,{fixed:"top",className:"top_menu"},n.a.createElement(f.a.Item,{icon:"th list",onClick:function(){e.setState({visible:!e.state.visible})}}),n.a.createElement(f.a.Item,{header:!0,onClick:function(){e.load(e.FEED)}},"Runtime Terror"),n.a.createElement(f.a.Item,{onClick:function(){e.load(e.PROFILE)}},a),s),n.a.createElement("div",{id:"sidebar"},n.a.createElement(xe.a.Pushable,{as:X.a},n.a.createElement(xe.a,{as:f.a,animation:"slide along",direction:"left",icon:"labeled",inverted:!0,vertical:!0,visible:this.state.visible,onHide:function(){return e.setState({visible:!1})},width:"thin"},n.a.createElement(f.a.Item,{onClick:function(){e.load(e.PROFILE)},name:"Profile"},n.a.createElement("br",null),r,n.a.createElement("br",null),"Profile"),",",n.a.createElement(f.a.Item,{onClick:function(){e.load(e.DISCOVER)},icon:"map",name:"Discover"}),",",n.a.createElement(f.a.Item,{onClick:function(){e.load(e.FEED)},icon:"sitemap",name:"Feed"}),",",n.a.createElement(f.a.Item,{onClick:this.props.signOut,name:"Sign out",icon:"sign out",position:"right"})),n.a.createElement(xe.a.Pusher,{dimmed:this.state.visible},this.props.content))));if(null!=this.state.redirect_target){var c=this.state.targets[this.state.redirect_target];return n.a.createElement("div",{className:"fullsize_div"},n.a.createElement(m.a,{to:c}),o)}return o}},{key:"componentDidUpdate",value:function(){null!=this.state.redirect_target&&this.setState({redirect_target:null})}}]),t}(r.Component),ze=Object(h.b)((function(e){return{auth:e.firebase.auth,profile:e.firebase.profile}}),(function(e){return{signOut:function(){return e((function(e,t){N.auth().signOut().then((function(){e({type:"SIGNOUT_SUCCESS"})}))}))}}}))(Me),Be=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("h1",null,"404: Page not found"))}}]),t}(r.Component),Ge=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={isLoading:!0},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.auth;console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/Mutter",REACT_APP_APP_ID:"1:714361214200:web:81690bccecf7b7ce18570d",REACT_APP_AUTH_DOMAIN:"runtime-terror-web.firebaseapp.com",REACT_APP_DATABASE_URL:"https://runtime-terror-web.firebaseio.com",REACT_APP_FIREBASE_API_KEY:"AIzaSyBMD75FP14e3VvxTRllOrc26K9vds7WHBs",REACT_APP_MESSAGING_SENDER_ID:"714361214200",REACT_APP_PROJECT_ID:"runtime-terror-web",REACT_APP_SPOTIFY_CLIENT_ID:"3a54934c90894909959dd11243291615",REACT_APP_STORAGE_BUCKET:"runtime-terror-web.appspot.com"}));var t=n.a.createElement(m.d,null,n.a.createElement(m.b,{exact:!0,path:"/",component:ge}),n.a.createElement(m.b,{path:"/login",component:oe}),n.a.createElement(m.b,{path:"/discover",component:W}),n.a.createElement(m.b,{path:"/tokenHandler",component:x}),n.a.createElement(m.b,{path:"/profile/:id",component:Ue}),n.a.createElement(m.b,{path:"/createpost",component:Oe}),n.a.createElement(m.b,{path:"/requests",component:Le}),n.a.createElement(m.b,{component:Be})),a=e.isLoaded&&e.uid?n.a.createElement(ze,{content:t}):n.a.createElement("div",null,n.a.createElement(m.a,{to:"/"}),n.a.createElement(f.a,null,n.a.createElement(f.a.Item,{header:!0},"Runtime Terror")),n.a.createElement(oe,null));return this.state.isLoading?n.a.createElement("div",{className:"fullsize_div"}," ",n.a.createElement(E.a,{active:!0,size:"massive"},"Loading")," "):n.a.createElement(p.a,{basename:"/Mutter"},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.auth.isLoaded&&(e.auth.isEmpty||e.auth.uid)?{isLoading:!1}:null}}]),t}(r.Component),qe=Object(h.b)((function(e){return{auth:e.firebase.auth}}))(Ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ve={authError:null},He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(_e.a)({},e,{authError:"Login Failed!"});case"LOGIN_SUCCESS":return console.log("login success"),Object(_e.a)({},e,{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return console.log("signup success"),Object(_e.a)({},e,{authError:null});case"SIGNUP_ERROR":return console.log("signup error"),Object(_e.a)({},e,{authError:t.err.message});case"USER_IMAGE":return console.log("Updated user image",t.uId,t.imageUrl),e;case"USER_IMAGE_ERROR":return console.log("Update user image error",t.err),e;case"USER_UPDATE":return console.log("Updated user profile",t.uId,t.newInfo),e;case"USER_UPDATE_ERROR":return console.log("Update user profile error",t.err),e;case"SEND_FRIEND_REQUEST":return console.log("Sent friend request",t.profile_user_id,t.logged_in_user_id),e;case"SEND_FRIEND_REQUEST_ERROR":return console.log("Send friend request error",t.err),e;case"REMOVE_FRIEND":return console.log("Sent friend request",t.profile_user_id,t.logged_in_user_id),e;case"REMOVE_FRIEND_ERROR":return console.log("Send friend request error",t.err),e;case"ACCEPT_FRIEND":return console.log("Accepted friend request",t.friend_user_id,t.logged_in_user_id),e;case"ACCEPT_FRIEND_ERROR":return console.log("Accept friend request error",t.err),e;case"REJECT_FRIEND":return console.log("Rejected friend request",t.friend_user_id,t.logged_in_user_id),e;case"REJECT_FRIEND_ERROR":return console.log("Reject friend request error",t.err),e;case"SPOTIFY_TOKEN":return console.log("Updated user spotify token",t.uId),e;case"SPOTIFY_TOKEN_ERROR":return console.log("Update user spotify token error",t.err),e;default:return e}},Ke={posts:[{song:null}]},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_POST":return console.log("Created post:",t.post),e;case"CREATE_POST_ERROR":return console.log("Create post error:",t.err),e;default:return e}},Je=a(111),We=Object(le.c)({auth:He,post:Ye,firestore:Je.firestoreReducer,firebase:ue.firebaseReducer}),Qe=a(336),$e=Object(le.e)(We,Object(le.d)(Object(le.a)(Qe.a.withExtraArgument({getFirebase:ue.getFirebase,getFirestore:Je.getFirestore})),Object(Je.reduxFirestore)(N))),Xe={firebase:N,config:{useFirestoreForProfile:!0,userProfile:"users",attachAuthIsReady:!0},dispatch:$e.dispatch,createFirestoreInstance:Je.createFirestoreInstance};s.a.render(n.a.createElement(h.a,{store:$e},n.a.createElement(ue.ReactReduxFirebaseProvider,Xe,n.a.createElement(qe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[350,1,2]]]);
//# sourceMappingURL=main.6ad0ac0b.chunk.js.map