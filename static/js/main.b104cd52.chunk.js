(this.webpackJsonpruntime_terror=this.webpackJsonpruntime_terror||[]).push([[0],{350:function(e,t,a){e.exports=a(588)},355:function(e,t,a){},588:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(72),s=a.n(i),o=(a(355),a(18)),l=a(19),c=a(20),u=a(21),d=a(22),m=a(81),p=a(56),h=a(42),f=a(28),g=a(338),E=a(603),v=a(309),y=a.n(v),b=a(314),_=a(590),k=a(609),O=a(611),S=a(337),P=a(612),R=a(601),C=a(613),I=a(602),j=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isOpen:!1},a.handleOpen=function(){a.setState({isOpen:!0}),a.timeout=setTimeout((function(){a.setState({isOpen:!1})}),1500)},a.handleClose=function(){a.setState({isOpen:!1}),clearTimeout(a.timeout)},a.makePost=function(){var e=a.props.create_url;window.location.href=e},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"playSong",value:function(){var e=this.props,t=e._token,a=e.url,n=e.uri,r=e.deviceid,i=e.type,s=e.account_type;"premium"===s?("track"===i&&fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{authorization:"Bearer ".concat(t)},query:{device_id:r},body:JSON.stringify({uris:[n]})}),"album"!==i&&"artist"!==i&&"playlist"!==i||fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{authorization:"Bearer ".concat(t)},query:{device_id:r},body:JSON.stringify({context_uri:n})})):"free"===s&&window.open(a,"_blank noreferrer noopener")}},{key:"render",value:function(){var e=this,t=this.props,a=t.title,n=t.artist,i=t.album,s=t.art_url,o=t.type,l=t.account_type,c=t.player_connected,u="premium"!==l||c?r.a.createElement(_.a,{fluid:!0,positive:!0,onClick:function(){return e.playSong()}},"Listen!"):r.a.createElement(k.a,{trigger:r.a.createElement(_.a,{fluid:!0,basic:!0,color:"green"},"Listen!"),content:"Please launch Web Player first!",on:"click",open:this.state.isOpen,onClose:this.handleClose,onOpen:this.handleOpen,position:"bottom center"});return r.a.createElement(O.a,{centered:!0,raised:!0},r.a.createElement(O.a.Content,null,"track"===o?r.a.createElement(k.a,{content:"Create a post",position:"top center",trigger:r.a.createElement(_.a,{floated:"right",icon:"plus",onClick:this.makePost})}):null,r.a.createElement(O.a.Header,null,a),r.a.createElement(O.a.Meta,null,i+" - "+n),r.a.createElement(S.a,{src:s})),r.a.createElement(O.a.Content,{extra:!0},u))}}]),t}(n.Component),w=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.song_info;if(Array.isArray(e)){var t=e.map((function(e,t){return r.a.createElement(b.a.Column,{stretched:!0,key:t},r.a.createElement(j,{title:e.title,artist:e.artist,album:e.album,art_url:e.art_url,url:e.url,create_url:e.create_url,_token:e._token,uri:e.uri,deviceid:e.deviceid,type:e.type,account_type:e.account_type,player_connected:e.player_connected}))})),a=Array(Math.ceil(e.length/5)).fill().map((function(e,a){return r.a.createElement(b.a.Row,{key:a},t.slice(5*a,5*a+5))}));return r.a.createElement(b.a,{columns:"equal"},a)}return null}}]),t}(n.Component),F=function e(t,a,n,r,i,s,l,c,u,d,m,p){Object(o.a)(this,e),this.title=t,this.artist=a,this.album=n,this.art_url=r,this.url=i,this.create_url=s,this._token=l,this.uri=c,this.deviceid=u,this.type=d,this.account_type=m,this.player_connected=p},U=w,T=a(316),A=a.n(T),N=function(e){var t=!1;return{promise:new Promise((function(a,n){e.then((function(e){t?n({isCancelled:!0}):a(e)})),e.catch((function(e){n(t?{isCancelled:!0}:e)}))})),cancel:function(){t=!0}}},D=a(317),L=a.n(D),x=new A.a,z="http://localhost:3000",M=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).handleSearchChange=function(t,a){var n=a.value;e.setState({value:n}),setTimeout((function(){if(e.state.value.length<1)return e.setState({value:"",results:[]});switch(e.state.searchButton){case"songs":e.searchTracks(n),e.setState({results:e.state.searchedTracks!==[]&&e.state.searchedTracks.tracks&&e.state.searchedTracks.tracks.items?e.state.searchedTracks.tracks.items:[]});break;case"artists":e.searchArtists(n),e.setState({results:e.state.searchedArtists!==[]&&e.state.searchedArtists.artists&&e.state.searchedArtists.artists.items?e.state.searchedArtists.artists.items:[]});break;case"albums":e.searchAlbums(n),e.setState({results:e.state.searchedAlbums!==[]&&e.state.searchedAlbums.albums&&e.state.searchedAlbums.albums.items?e.state.searchedAlbums.albums.items:[]});break;case"playlists":e.searchPlaylists(n),e.setState({results:e.state.searchedPlaylists!==[]&&e.state.searchedPlaylists.playlists&&e.state.searchedPlaylists.playlists.items?e.state.searchedPlaylists.playlists.items:[]});break;default:e.setState({results:[]})}}),20)},e.onPrevClick=function(){e.state.player_connected&&e.player.previousTrack()},e.onPlayClick=function(){e.state.player_connected&&e.player.togglePlay()},e.onNextClick=function(){e.state.player_connected&&e.player.nextTrack()},e.createPost=function(){void 0===e.state.trackUrl?window.location.href=z+"/createpost/#SongName="+e.state.trackName:window.location.href=z+"/createpost/#SongName="+e.state.trackName+"&SongUrl="+e.state.trackUrl},e.state={loggedIn:!1,searchButton:"songs",searchedTracks:[],searchedArtists:[],searchedAlbums:[],searchedPlaylists:[],value:"",results:[],newReleases:[],recentlyPlayed:[],topTracks:[],_token:"",deviceId:"",error:"",trackName:void 0,trackUrl:void 0,artistName:void 0,albumName:void 0,playing:!1,position:0,duration:1,albumArt:"",player_connected:!1,account_type:"Not Logged In. Click to authenticate!",accountTypePromise:null,newReleasesPromise:null,recentSongsPromise:null,topTracksPromise:null,searchTracksPromise:null,searchArtistsPromise:null,searchAlbumsPromise:null,searchPlaylistsPromise:null,initializeOnceMounted:void 0},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onRouteChange",value:function(e){this.state.player_connected&&this.player.disconnect()}},{key:"initialize",value:function(){if(this.state.loggedIn){clearInterval(this.initializeOnceMounted);var e=this.state._token,t=x.getAccessToken();e?x.setAccessToken(e):t&&x.setAccessToken(t),this.getAccountType(),this.getNewReleases(),this.getRecentSongs(),this.getTopTracks(),this.playerCheckInterval=null,this.props.history.listen(this.onRouteChange.bind(this))}}},{key:"componentDidMount",value:function(){var e=this;this.initializeOnceMounted=setInterval((function(){return e.initialize()}),20)}},{key:"componentWillUnmount",value:function(){for(var e=this.state,t=[e.accountTypePromise,e.newReleasesPromise,e.recentSongsPromise,e.topTracksPromise,e.searchTracksPromise,e.searchArtistsPromise,e.searchAlbumsPromise,e.searchPlaylistsPromise],a=0;a<t.length;a++)t[a]&&t[a].cancel();void 0!==this.initializeOnceMounted&&clearInterval(this.initializeOnceMounted)}},{key:"getAccountType",value:function(){var e=this,t=N(x.getMe());this.setState({accountTypePromise:t},(function(){t.promise.then((function(t){var a="premium"===t.product?"premium":"free";return e.setState({account_type:a}),t}),(function(e){console.log("Something went wrong!",e),401===e.status&&window.confirm("Token Expired! Please re-login to Spotify!")&&(window.location.href="http://localhost:8888")}))}))}},{key:"getNewReleases",value:function(){var e=this,t=N(x.getNewReleases({limit:5,offset:0,country:"US"}));this.setState({newReleasesPromise:t},(function(){t.promise.then((function(t){return e.setState({newReleases:t.albums.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"getRecentSongs",value:function(){var e=this,t=N(x.getMyRecentlyPlayedTracks({limit:5}));this.setState({recentSongsPromise:t},(function(){t.promise.then((function(t){return e.setState({recentlyPlayed:t.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"getTopTracks",value:function(){var e=this,t=N(x.getMyTopTracks({limit:5}));this.setState({topTracksPromise:t},(function(){t.promise.then((function(t){return e.setState({topTracks:t.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"searchTracks",value:function(e){var t=this,a=N(x.searchTracks(e));this.setState({searchTracksPromise:a}),a.promise.then((function(e){return t.setState({searchedTracks:e}),e}),(function(e){console.error(e)}))}},{key:"searchAlbums",value:function(e){var t=this,a=N(x.searchAlbums(e));this.setState({searchAlbumsPromise:a}),a.promise.then((function(e){return t.setState({searchedAlbums:e}),e}),(function(e){console.error(e)}))}},{key:"searchArtists",value:function(e){var t=this,a=N(x.searchArtists(e));this.setState({searchArtistsPromise:a}),a.promise.then((function(e){return t.setState({searchedArtists:e}),e}),(function(e){console.error(e)}))}},{key:"searchPlaylists",value:function(e){var t=this,a=N(x.searchPlaylists(e));this.setState({searchPlaylistsPromise:a}),a.promise.then((function(e){return t.setState({searchedPlaylists:e}),e}),(function(e){console.error(e)}))}},{key:"checkForPlayer",value:function(){var e=this.state._token;if(null!==window.Spotify){clearInterval(this.playerCheckInterval),this.player=new window.Spotify.Player({name:"Runtime Terror's Spotify Player",getOAuthToken:function(t){t(e)}}),this.createEventHandlers(),this.player.connect();this.setState({player_connected:!0})}}},{key:"checkForPlayer_driver",value:function(){var e=this;this.playerCheckInterval=setInterval((function(){return e.checkForPlayer()}),10)}},{key:"createEventHandlers",value:function(){var e=this;this.player.on("initialization_error",(function(e){console.error(e)})),this.player.on("authentication_error",(function(t){console.error(t),e.setState({loggedIn:!1})})),this.player.on("account_error",(function(e){console.error(e)})),this.player.on("playback_error",(function(e){console.error(e)})),this.player.on("player_state_changed",(function(t){return e.onStateChanged(t)})),this.player.on("ready",(function(t){var a;return y.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:a=t.device_id,console.log("Let the music play on!"),e.setState({deviceId:a}),e.transferPlaybackHere();case 4:case"end":return n.stop()}}))}))}},{key:"onStateChanged",value:function(e){if(null!==e){var t=e.track_window,a=t.current_track,n=t.position,r=t.duration,i=a.name,s="https://open.spotify.com/track/"+a.id,o=a.album.name,l=a.artists.map((function(e){return e.name})).join(", "),c=!e.paused,u=a.album.images[0].url;this.setState({position:n,duration:r,trackName:i,trackUrl:s,albumName:o,artistName:l,playing:c,albumArt:u})}}},{key:"transferPlaybackHere",value:function(){var e=this.state,t=e.deviceId,a=e._token;fetch("https://api.spotify.com/v1/me/player",{method:"PUT",headers:{authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({device_ids:[t],play:!1})})}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.value,i=a.results,s=a.recentlyPlayed,o=a.topTracks,l=a.newReleases,c=a.trackName,u=a.artistName,d=a.albumName,m=a.albumArt,p=a.playing,h=a._token,f=a.deviceId,E=a.account_type,v=a.player_connected,y=[],R=[],C=[],I=[];if("undefined"!==i)for(e=0;e<Math.min(i.length,5);e++){var j=i[e].name,w="track"===i[e].type?i[e].artists[0].name:"playlist"===i[e].type?i[e].owner.display_name:"album"===i[e].type?i[e].artists[0].name:"",U="track"===i[e].type?i[e].album.name:"",T="artist"===i[e].type||"playlist"===i[e].type||"album"===i[e].type?i[e].images.length>0?i[e].images[0].url:"":i[e].album.images[0].url,A=i[e].external_urls.spotify,N=h,D=i[e].uri,x=f,M=i[e].type,B=z+"/createpost/#SongName="+j+"&SongUrl="+A;y.push(new F(j,w,U,T,A,B,N,D,x,M,E,v))}if("undefined"!==s)for(e=0;e<Math.min(s.length,5);e++){var G=s[e].track.name,V=s[e].track.artists[0].name,H=s[e].track.album.name,J=s[e].track.album.images[0].url,W=s[e].track.external_urls.spotify,Q=h,Y=s[e].track.uri,K=f,$=s[e].track.type,X=z+"/createpost/#SongName="+G+"&SongUrl="+W;C.push(new F(G,V,H,J,W,X,Q,Y,K,$,E,v))}if("undefined"!==o)for(e=0;e<Math.min(o.length,5);e++){var Z=o[e].name,ee=o[e].artists[0].name,te=o[e].album.name,ae=o[e].album.images[0].url,ne=o[e].external_urls.spotify,re=h,ie=o[e].uri,se=f,oe=o[e].type,le=z+"/createpost/#SongName="+Z+"&SongUrl="+ne;I.push(new F(Z,ee,te,ae,ne,le,re,ie,se,oe,E,v))}if("undefined"!==l)for(e=0;e<Math.min(l.length,5);e++){var ce=l[e].name,ue=l[e].artists[0].name,de=l[e].images[0].url,me=l[e].external_urls.spotify,pe=h,he=l[e].uri,fe=f,ge=l[e].type,Ee=z+"/createpost/#SongName="+ce+"&SongUrl="+me;R.push(new F(ce,ue,"",de,me,Ee,pe,he,fe,ge,E,v))}var ve=r.a.createElement(g.a.Item,null,r.a.createElement(b.a,null,r.a.createElement(_.a,{key:0,inverted:!0,icon:"backward",onClick:this.onPrevClick}),r.a.createElement(_.a,{key:1,inverted:!0,icon:p?"pause":"play",onClick:this.onPlayClick}),r.a.createElement(_.a,{key:2,inverted:!0,icon:"forward",onClick:this.onNextClick}),r.a.createElement(k.a,{key:3,trigger:r.a.createElement(g.a.Item,null,c),position:"bottom center"},r.a.createElement(k.a.Content,null,r.a.createElement(O.a,{centered:!0,raised:!0},r.a.createElement(O.a.Content,null,r.a.createElement(O.a.Header,null,c),r.a.createElement(O.a.Meta,null,d+" - "+u),r.a.createElement(S.a,{src:m}))))),r.a.createElement(k.a,{key:4,trigger:r.a.createElement(_.a,{inverted:!0,icon:"plus",onClick:this.createPost}),position:"bottom center"},r.a.createElement(k.a.Content,null,"Create post"))));return r.a.createElement("div",{className:"Discover"},r.a.createElement(g.a,{inverted:!0},"premium"===this.state.account_type?!this.state.loggedIn||this.state.player_connected&&void 0!==c?ve:r.a.createElement(g.a.Item,{onClick:function(){return t.checkForPlayer_driver()}},"Launch Web Player"):null,r.a.createElement(g.a.Item,{position:"right",onClick:function(){return console.log()}},r.a.createElement(b.a,{centered:!0},r.a.createElement(P.a,{fluid:!0,showNoResults:!1,size:"large",onSearchChange:L.a.debounce(this.handleSearchChange,20),value:n,placeholder:"Search for "+this.state.searchButton+"..."}),r.a.createElement(_.a.Group,{labeled:!0},r.a.createElement(_.a,{positive:"songs"===this.state.searchButton,secondary:!0,content:"Song",onClick:function(){return t.setState({value:"",results:[],searchButton:"songs"})}}),r.a.createElement(_.a,{positive:"artists"===this.state.searchButton,secondary:!0,content:"Artist",onClick:function(){return t.setState({value:"",results:[],searchButton:"artists"})}}),r.a.createElement(_.a,{positive:"albums"===this.state.searchButton,secondary:!0,content:"Album",onClick:function(){return t.setState({value:"",results:[],searchButton:"albums"})}}),r.a.createElement(_.a,{positive:"playlists"===this.state.searchButton,secondary:!0,content:"Playlist",onClick:function(){return t.setState({value:"",results:[],searchButton:"playlists"})}})))),this.state.loggedIn?r.a.createElement(g.a.Item,{href:"http://localhost:8888"},"Spotify Status: ",r.a.createElement("p",{style:{color:"premium"===this.state.account_type?"gold":"green",whiteSpace:"pre"}}," ",this.state.account_type.charAt(0).toUpperCase()+this.state.account_type.slice(1)," ")):r.a.createElement(g.a.Item,{href:"http://localhost:8888"},"Sign In To Spotify")),this.state.loggedIn||""!==this.state._token?null:r.a.createElement("p",{align:"center",style:{color:"#139bd1",fontSize:"26px"}},"Welcome! ",r.a.createElement("br",null)," Please log into Spotify to get started."),0!==y.length?r.a.createElement(q,{title:"Search Results",song_info:y,expand:this.expandSection}):null,0!==C.length?r.a.createElement(q,{title:"Recent Songs",song_info:C}):null,0!==I.length?r.a.createElement(q,{title:"Your Top Picks",song_info:I}):null,0!==R.length?r.a.createElement(q,{title:"New Releases",song_info:R}):null,r.a.createElement("br",null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.profile.isLoaded&&e.profile.spotify_token&&t._token!==e.profile.spotify_token?{_token:e.profile.spotify_token,loggedIn:!0}:null}}]),t}(n.Component),q=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.song_info;return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(R.a,{fluid:!0},r.a.createElement(C.a,{as:"h2",textAlign:"center"},t),r.a.createElement(I.a,null),r.a.createElement(U,{song_info:a}),r.a.createElement(I.a,{hidden:!0}),r.a.createElement(I.a,{hidden:!0})))}}]),t}(n.Component),B=Object(f.b)((function(e){return{profile:e.firebase.profile}}))(M),G=a(218),V=a.n(G);a(485),a(487);V.a.initializeApp({apiKey:"AIzaSyBMD75FP14e3VvxTRllOrc26K9vds7WHBs",authDomain:"runtime-terror-web.firebaseapp.com",databaseURL:"https://runtime-terror-web.firebaseio.com",projectId:"runtime-terror-web",storageBucket:"runtime-terror-web.appspot.com",messagingSenderId:"714361214200",appId:"1:714361214200:web:81690bccecf7b7ce18570d"});var H=V.a,J=function(e,t){return function(a,n,r){r.getFirebase;var i=(0,r.getFirestore)();i.collection("users").doc(t).update({friends_pending:i.FieldValue.arrayRemove(e)}),i.collection("users").doc(t).update({friends:i.FieldValue.arrayUnion(e)}),i.collection("users").doc(e).update({friends:i.FieldValue.arrayUnion(t)}).then((function(){a({type:"ACCEPT_FRIEND",friend_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"ACCEPT_FRIEND_ERROR",err:e})}))}},W=function(e){function t(){var e;Object(o.a)(this,t);var a=(e=Object(c.a)(this,Object(u.a)(t).call(this))).getHashParams().access_token;return e.state={token:a||""},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);for(e=a.exec(n);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(n);return t}},{key:"componentDidMount",value:function(){this.handleToken()}},{key:"handleToken",value:function(){var e=this;this.props.auth&&!this.props.auth.isEmpty&&""!==this.state.token&&this.props.updateToken(this.props.auth.uid,this.state.token,(function(){return e.props.history.push("/discover")}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"fullsize_div"},r.a.createElement(E.a,{active:!0,size:"massive"},"Redirecting..."))}}]),t}(n.Component),Q=Object(f.b)((function(e){return{auth:e.firebase.auth}}),(function(e){return{updateToken:function(t,a,n){return e(function(e,t,a){return function(n,r,i){i.getFirebase;(0,i.getFirestore)().collection("users").doc(e).update({spotify_token:t}).then((function(){n({type:"SPOTIFY_TOKEN",uId:e})})).catch((function(e){n({type:"SPOTIFY_TOKEN_ERROR",err:e})})),a()}}(t,a,n))}}}))(W),Y=a(315),K=a(313),$=a(75),X=a(222),Z=a(31),ee=a(606),te=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",name:""},a.submit=function(){a.props.signUp(a.state)},a.change=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.authError;return r.a.createElement(ee.a,{onSubmit:this.submit},r.a.createElement(ee.a.Field,null,r.a.createElement(ee.a.Input,{label:"Email",id:"email",placeholder:"Enter your email",onChange:this.change})),r.a.createElement(ee.a.Field,null,r.a.createElement(ee.a.Input,{label:"Password",id:"password",placeholder:"Enter your password",type:"password",onChange:this.change})),r.a.createElement(ee.a.Field,null,r.a.createElement(ee.a.Input,{label:"Name",id:"name",placeholder:"Enter your name",onChange:this.change})),e?r.a.createElement("p",{style:{color:"red"}},e):null,r.a.createElement(ee.a.Field,{control:_.a},r.a.createElement(K.a,null,r.a.createElement($.a,{name:"headphones"}),"Sign Up")))}}]),t}(n.Component),ae=Object(f.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signUp:function(t){return e(function(e){return function(t,a,n){var r=(0,n.getFirestore)();H.auth().createUserWithEmailAndPassword(e.email,e.password).then((function(t){r.collection("users").doc(t.user.uid).set({name:e.name,friends:[],friends_pending:[],privacy:"public",spotify_token:"",imageUrl:"https://firebasestorage.googleapis.com/v0/b/runtime-terror-1d144.appspot.com/o/profile_images%2Fdefault_pic.png?alt=media&token=74c12ae4-d4ca-4ad2-af25-c38c2206ee43"})})).then((function(){t({type:"SIGNUP_SUCCESS"})})).catch((function(e){t({type:"SIGNUP_ERROR",err:e})}))}}(t))}}}))(te),ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.submit=function(){a.props.signIn(a.state)},a.change=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.authError;return r.a.createElement(ee.a,{onSubmit:this.submit},r.a.createElement(ee.a.Field,null,r.a.createElement(ee.a.Input,{label:"Email",id:"email",placeholder:"Enter your email",onChange:this.change})),r.a.createElement(ee.a.Field,null,r.a.createElement(ee.a.Input,{label:"Password",id:"password",placeholder:"Enter your password",type:"password",onChange:this.change})),e?r.a.createElement("p",{style:{color:"red"}},e):null,r.a.createElement(ee.a.Field,{control:_.a,fluid:!0},r.a.createElement(K.a,null,r.a.createElement($.a,{name:"headphones"}),"Sign In")))}}]),t}(n.Component),re=Object(f.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signIn:function(t){return e((a=t,function(e,t){H.auth().signInWithEmailAndPassword(a.email,a.password).then((function(){e({type:"LOGIN_SUCCESS"})})).catch((function(t){e({type:"LOGIN_ERROR",err:t})}))}));var a}}}))(ne),ie=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={signing_up:!1},a.sign_up=function(e){a.setState({signing_up:e})},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state.signing_up?r.a.createElement(ae,null):r.a.createElement(re,null);return r.a.createElement("div",null,r.a.createElement(_.a.Group,null,r.a.createElement(_.a,{color:"yellow",onClick:function(){e.sign_up(!0)}},r.a.createElement(K.a,null,r.a.createElement($.a,{name:"plus"}),"Sign Up")),r.a.createElement(_.a.Or,null),r.a.createElement(_.a,{color:"yellow",onClick:function(){e.sign_up(!1)}},r.a.createElement(K.a,null,r.a.createElement($.a,{name:"music"}),"Sign In"))),r.a.createElement(X.a,null,t))}}]),t}(n.Component),se=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.auth;return e.isLoaded&&e.uid?r.a.createElement(m.a,{to:"/"}):r.a.createElement(b.a,{padded:!0,centered:!0},r.a.createElement(S.a,{src:"img/silhouette_2.png"}),r.a.createElement(Y.a,null," ",r.a.createElement(ie,null)," "))}}]),t}(n.Component),oe=Object(f.b)((function(e){return{auth:e.firebase.auth}}))(se),le=a(616),ce=a(40),ue=a(60),de=a(323),me=a.n(de),pe=a(608),he=function(e){var t=e.post,a=e.users,n=a&&t?a.filter((function(e){return e.id===t.authorId}))[0]:null,i=r.a.createElement("div",null,r.a.createElement(p.b,{to:"/profile/"+t.authorId}," ",t.author," "),"rated song ",r.a.createElement("b",null,r.a.createElement("a",{href:t.url?t.url:null}," ",t.song," ")),r.a.createElement("span",{className:"fa fa-star "+(t.rating>=1?"star_checked":"")}),r.a.createElement("span",{className:"fa fa-star "+(t.rating>=2?"star_checked":"")}),r.a.createElement("span",{className:"fa fa-star "+(t.rating>=3?"star_checked":"")}),r.a.createElement("span",{className:"fa fa-star "+(t.rating>=4?"star_checked":"")}),r.a.createElement("span",{className:"fa fa-star "+(t.rating>=5?"star_checked":"")}));return n&&t?r.a.createElement("div",null,r.a.createElement(pe.a,{size:"large"},r.a.createElement(pe.a.Event,{image:n.imageUrl,date:me()(t.createdAt.toDate()).format("LLLL"),summary:i,extraText:t.comment})),r.a.createElement(I.a,null)):null},fe=function(e){var t=e.posts,a=e.users;return r.a.createElement("div",null,t&&0===t.length?r.a.createElement("h3",null,"No Posts Yet!"):null,t&&t.map((function(e){return r.a.createElement(he,{key:e.id,post:e,users:a})})))},ge=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={friendsPosts:null,explorePosts:null,users:null},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=[{menuItem:"Friends",render:function(){return r.a.createElement(le.a.Pane,null,r.a.createElement(fe,{posts:e.state.friendsPosts,users:e.state.users}))}},{menuItem:"Explore",render:function(){return r.a.createElement(le.a.Pane,null,r.a.createElement(fe,{posts:e.state.explorePosts,users:e.state.users}))}}];return r.a.createElement("div",null,r.a.createElement(I.a,{hidden:!0}),r.a.createElement(le.a,{panes:t}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={};return e.explorePosts!==t.explorePosts&&Object.assign(a,{explorePosts:e.explorePosts}),void 0!==e.friendsPosts&&e.friendsPosts!==t.friendsPosts&&Object.assign(a,{friendsPosts:e.friendsPosts}),void 0!==e.users&&e.users!==t.users&&Object.assign(a,{users:e.users}),0!==a.length?a:null}}]),t}(n.Component),Ee=Object(ce.d)(Object(f.b)((function(e){var t=["0"];for(var a in e.firestore.ordered.users)e.firebase.auth.uid===e.firestore.ordered.users[a].id&&(t=e.firestore.ordered.users[a].friends);if(null!=e.firestore.ordered.friendsPosts)var n=e.firestore.ordered.friendsPosts.sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds}));if(e.firestore.ordered.publicPosts)var r=e.firestore.ordered.publicPosts.sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds}));return{explorePosts:r,friendsPosts:n,auth:e.firebase.auth,users:e.firestore.ordered.users,currentFriendsList:t}})),Object(ue.firestoreConnect)((function(e){return[{collection:"users"},{collection:"posts",storeAs:"friendsPosts",where:["authorId","in",null===e.currentFriendsList||0===e.currentFriendsList.length?["0"]:e.currentFriendsList]},{collection:"posts",storeAs:"publicPosts",where:["privacy","==","public"]}]})))(ge),ve=a(128),ye=a(607),be=a(109),_e=a(98),ke=a(604),Oe=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this))).handleChange=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a.handleRating=function(e,t){var n=t.value;a.setState({rating:n})},a.handleSubmit=function(e){e.preventDefault(),a.state.rating?(a.props.createPost({song:a.state.song,comment:a.state.comment,rating:a.state.rating,privacy:a.state.privacy,url:a.state.url}),a.props.history.push("/")):a.setState({error:"Rating is required!"})},a.toggle=function(){a.setState({privacy:"private"===a.state.privacy?"public":"private"})};var n=a.getHashParams(),r=n.SongName,i=n.SongUrl;return a.state={song:r||"",comment:"",rating:"",url:i||"",privacy:e.profile.privacy,error:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);for(e=a.exec(n);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(n);return t}},{key:"render",value:function(){return r.a.createElement(R.a,{text:!0},r.a.createElement(I.a,{hidden:!0}),r.a.createElement(C.a,{as:"h2"},"Create Post"),r.a.createElement(ee.a,{onSubmit:this.handleSubmit},r.a.createElement(ee.a.Group,{widths:"equal"},r.a.createElement(ee.a.Input,{id:"song",label:"Song",name:"Song",required:!this.state.song,readOnly:!!this.state.url,placeholder:this.state.song,onChange:this.handleChange}),r.a.createElement(ee.a.Input,{id:"url",label:"URL",name:"URL",readOnly:!0,disabled:!this.state.url,placeholder:this.state.url,onChange:this.handleChange})),r.a.createElement(ee.a.Field,{control:ke.a,toggle:!0,label:"private"===this.state.privacy?"This post will be Private":"This post will be Public",defaultChecked:"private"===this.state.privacy,onClick:this.toggle}),r.a.createElement(ee.a.Dropdown,{id:"rating",label:"Rating",placeholder:"Select",required:!0,inline:!0,error:this.state.error,onChange:this.handleRating,options:[{text:"1",value:1},{text:"2",value:2},{text:"3",value:3},{text:"4",value:4},{text:"5",value:5}]}),r.a.createElement(ee.a.TextArea,{id:"comment",label:"Comment",name:"Comment",onChange:this.handleChange}),r.a.createElement(ee.a.Button,{type:"submit",color:"green"},"Create Post")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.profile&&e.profile.isLoaded&&void 0!==e.profile.privacy&&void 0===t.privacy?{privacy:e.profile.privacy}:null}}]),t}(n.Component),Se=Object(f.b)((function(e){return{profile:e.firebase.profile}}),(function(e){return{createPost:function(t){return e((a=t,function(e,t,n){n.getFirebase;var r=(0,n.getFirestore)(),i=t().firebase.profile,s=t().firebase.auth.uid;r.collection("posts").add(Object(_e.a)({},a,{author:i.name,authorId:s,createdAt:new Date})).then((function(){e({type:"CREATE_POST",post:a})})).catch((function(t){e({type:"CREATE_POST_ERROR",err:t})}))}));var a}}}))(Oe),Pe=function(e){var t=e.friends,a=e.users;return r.a.createElement("div",null,t&&0===t.length?r.a.createElement("h3",null,"No Friends Yet :("):null,t&&a&&t.map((function(e){var t=a.filter((function(t){return t.id===e}))[0],n=t?r.a.createElement(p.b,{to:"/profile/"+e}," ",t.name," "):null;return r.a.createElement(pe.a,{key:e},r.a.createElement(pe.a.Event,{image:t?t.imageUrl:null,summary:n}),r.a.createElement(I.a,{fitted:!0}))})))},Re=a(221),Ce=a.n(Re),Ie=a(324),je=a.n(Ie),we=a(605),Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this))).state={image:"",isUploading:!1,progress:0,imageURL:"",open:!1},a.handleUploadStart=function(){a.setState({isUploading:!0,progress:0,imageURL:null,image:null})},a.handleProgress=function(e){return a.setState({progress:e})},a.handleUploadError=function(e){a.setState({isUploading:!1}),console.error(e)},a.handleUploadSuccess=function(e){a.setState({image:e,progress:100,isUploading:!1}),Ce.a.storage().ref("profile_images").child(e).getDownloadURL().then((function(e){a.setState({imageURL:e}),a.props.updateImage(a.uId,e),a.handleModalClose()}))},a.handleModalClose=function(){a.setState({image:"",isUploading:!1,progress:0,imageURL:"",open:!1})},a.uId=e.uId,a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.previousImageUrl;return r.a.createElement(ye.a,{trigger:r.a.createElement(S.a,{src:t,size:"medium",circular:!0,bordered:!0}),open:this.state.open,onOpen:function(){return e.setState({open:!0})},closeOnDimmerClick:!1,closeOnDocumentClick:!1,size:"small"},r.a.createElement(ye.a.Content,null,r.a.createElement(b.a,{divided:!0,stretched:!0,centered:!0},r.a.createElement(b.a.Row,{stretched:!0},r.a.createElement(b.a.Column,{stretched:!0},r.a.createElement(C.a,{as:"h2"},"Current"),r.a.createElement(S.a,{src:t,wrapped:!0,size:"medium",href:t,bordered:!0}))),r.a.createElement(b.a.Row,{stretched:!0},r.a.createElement(b.a.Column,{stretched:!0},r.a.createElement(b.a,{stretched:!0,columns:16},r.a.createElement(b.a.Row,null,r.a.createElement(b.a.Column,{width:6},r.a.createElement(je.a,{accept:"image/*",name:"image",filename:this.uId,storageRef:Ce.a.storage().ref("profile_images"),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress})),r.a.createElement(b.a.Column,{width:10},this.state.imageURL?r.a.createElement(we.a,{percent:100,success:!0},"Uploaded"):this.state.isUploading?r.a.createElement(we.a,{percent:this.state.progress,progress:!0,color:"blue"}):null))))))),r.a.createElement(ye.a.Actions,null,r.a.createElement(_.a,{color:"red",onClick:function(){e.setState({open:!1})}},"Cancel")))}}]),t}(n.Component),Ue=Object(f.b)(null,(function(e){return{updateImage:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;(0,r.getFirestore)().collection("users").doc(e).update({imageUrl:t}).then((function(){a({type:"USER_IMAGE",uId:e,imageUrl:t})})).catch((function(e){a({type:"USER_IMAGE_ERROR",err:e})}))}}(t,a))}}}))(Fe),Te=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={posts_content:null,friends_content:null,navigate:null,open:!1,name:"",privacy:null,profile:null},a.navigate=function(e){a.setState({navigate:e})},a.handleChange=function(e){a.setState(Object(Z.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){a.handleSubmitPrivacy(e,a.state.privacy)},a.handleSubmitPrivacy=function(e,t){e.preventDefault(),a.props.updateProfile(a.props.auth.uid,{name:a.state.name,privacy:t,profile:a.state.profile}),a.props.history.push("/profile/"+a.props.auth.uid),a.setState({open:!1})},a.togglePrivacy=function(e){var t="private"===a.state.privacy?"public":"private";a.setState({privacy:t}),a.handleSubmitPrivacy(e,t)},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.auth,n=t.users,i=t.profile,s=t.match,o=t.curProfilePosts,l=t.currentFriendsList,c=n&&a?n.filter((function(e){return e.id===s.params.id}))[0]:null,u=c?c.imageUrl:null,d=a.uid&&s.params&&a.uid===s.params.id,p=s&&a?r.a.createElement(_.a,{onClick:function(){e.props.addFriend(s.params.id,a.uid)}},"Add Friend"):null;a&&c&&c.friends_pending&&c.friends_pending.includes(a.uid)?p=r.a.createElement(_.a,null,"Friend Request Sent"):a&&c&&c.friends.includes(a.uid)&&s?p=r.a.createElement(_.a,{onClick:function(){e.props.removeFriend(s.params.id,a.uid)}},"Remove Friend"):i&&i.friends_pending&&a&&s&&i.friends_pending.includes(s.params.id)&&(p=r.a.createElement(_.a,{onClick:function(){e.props.acceptFriend(s.params.id,a.uid)}},"Accept Friend Request"));var h=r.a.createElement("div",null," ",r.a.createElement(fe,{posts:o,users:n})," "),f=c?l&&s&&s.params&&s.params.id&&l.includes(s.params.id)||a&&s&&s.params&&s.params.id&&a.uid===s.params.id?r.a.createElement("div",null," ",r.a.createElement(Pe,{users:n,friends:c.friends})," "):r.a.createElement("div",null," ",r.a.createElement(Pe,{users:n,friends:[]})," "):null,g=[{menuItem:"Posts",render:function(){return r.a.createElement(le.a.Pane,null,h)}},{menuItem:"Friends",render:function(){return r.a.createElement(le.a.Pane,null,f)}}];return"/createpost"===this.state.navigate?r.a.createElement("div",null,r.a.createElement(m.a,{to:this.state.navigate}),r.a.createElement(Se,null)):r.a.createElement("div",null,r.a.createElement(b.a,{centered:!0,padded:"vertically"},r.a.createElement(Y.a,null,r.a.createElement(X.a,null,d?r.a.createElement(Ue,{uId:a.uid,previousImageUrl:u}):r.a.createElement(S.a,{src:u,size:"medium",circular:!0,bordered:!0}),r.a.createElement("br",null),r.a.createElement(_.a,{as:"div",labelPosition:"left"},r.a.createElement(ve.a,{basic:!0},c?c.name:null),d?r.a.createElement(ye.a,{trigger:r.a.createElement(_.a,{compact:!0,icon:"edit"}),open:this.state.open,onOpen:function(){return e.setState({open:!0})},closeOnDimmerClick:!1,closeOnDocumentClick:!1,size:"small"},r.a.createElement(ye.a.Content,null,r.a.createElement(ee.a,{onSubmit:this.handleSubmit},r.a.createElement(ee.a.Field,null,r.a.createElement("label",null,"New Name"),r.a.createElement(ee.a.Input,{id:"name",onChange:this.handleChange,placeholder:c?c.name:""})),r.a.createElement(_.a,{type:"submit",color:"green"},"Change name"),r.a.createElement(_.a,{floated:"right",color:"red",onClick:function(){return e.setState({open:!1})}},"Cancel")))):null),d?r.a.createElement("div",null,r.a.createElement(b.a,null,r.a.createElement(b.a.Column,{floated:"left"},r.a.createElement(_.a,{onClick:this.togglePrivacy,basic:!0,size:"small",color:"private"===this.state.privacy?"red":"green"},"private"===this.state.privacy?"Private":"Public")),r.a.createElement(b.a.Column,{floated:"right"},r.a.createElement(_.a,{floated:"right",icon:"plus",onClick:function(){e.navigate("/createpost")}})))):p)),r.a.createElement(Y.a,null," ",r.a.createElement(be.a,{width:16}," ",r.a.createElement(le.a,{panes:g})," ")," ")))}},{key:"componentDidUpdate",value:function(){null!=this.state.navigate&&this.navigate(null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={};return(null===t.profile||t.profile.isLoading)&&e.profile&&(void 0!==e.profile.privacy&&Object.assign(a,{privacy:e.profile.privacy,profile:e.profile}),void 0!==e.profile.name&&Object.assign(a,{name:e.profile.name})),a}}]),t}(n.Component),Ae=Object(ce.d)(Object(f.b)((function(e){var t=["0"];for(var a in e.firestore.ordered.users)e.firebase.auth.uid===e.firestore.ordered.users[a].id&&(t=e.firestore.ordered.users[a].friends);var n=[];return null!=e.firestore.ordered.curPrivatePosts&&null!=e.firestore.ordered.curPublicPosts?n=e.firestore.ordered.curPrivatePosts.concat(e.firestore.ordered.curPublicPosts).sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds})):null!=e.firestore.ordered.curPublicPosts?n=e.firestore.ordered.publicPosts:null!=e.firestore.ordered.curPrivatePosts&&(n=e.firestore.ordered.curPrivatePosts),{curProfilePosts:n,auth:e.firebase.auth,profile:e.firebase.profile,users:e.firestore.ordered.users,currentFriendsList:t}}),(function(e){return{addFriend:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;var i=(0,r.getFirestore)();i.collection("users").doc(e).update({friends_pending:i.FieldValue.arrayUnion(t)}).then((function(){a({type:"SEND_FRIEND_REQUEST",profile_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"SEND_FRIEND_REQUEST_ERROR",err:e})}))}}(t,a))},removeFriend:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;var i=(0,r.getFirestore)();i.collection("users").doc(e).update({friends:i.FieldValue.arrayRemove(t)}),i.collection("users").doc(t).update({friends:i.FieldValue.arrayRemove(e)}).then((function(){a({type:"REMOVE_FRIEND",profile_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"REMOVE_FRIEND_ERROR",err:e})}))}}(t,a))},acceptFriend:function(t,a){return e(J(t,a))},updateProfile:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;var i=(0,r.getFirestore)(),s=t.name,o=t.privacy;i.collection("users").doc(e).update({name:s,privacy:o}).then((function(){a({type:"USER_UPDATE",uId:e,newInfo:t})})).catch((function(e){a({type:"USER_UPDATE_ERROR",err:e})}))}}(t,a))}}})),Object(ue.firestoreConnect)((function(e){return[{collection:"users"},{collection:"posts",storeAs:"curPrivatePosts",where:[["authorId","==",e.match.params.id],["privacy","==",null===e.currentFriendsList||e.match.params.id!==e.auth.uid&&!e.currentFriendsList.includes(e.match.params.id)?"0":"private"]]},{collection:"posts",storeAs:"curPublicPosts",where:[["authorId","==",e.match.params.id],["privacy","==","public"]]}]})))(Te),Ne=a(610),De=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.users,n=e.profile,i=e.acceptFriend,s=e.rejectFriend,o=n?n.friends_pending:null;return r.a.createElement("div",null,r.a.createElement(R.a,{text:!0},r.a.createElement(I.a,{hidden:!0}),o&&0===o.length?r.a.createElement("h3",null,"No Friends Requests"):null,o&&a&&o.map((function(e){var n=a.filter((function(t){return t.id===e}))[0],o=n?r.a.createElement(p.b,{to:"/profile/"+e}," ",n.name," "):null;return r.a.createElement(Ne.a,{divided:!0,animated:!0,relaxed:!0,verticalAlign:"middle",size:"big",key:e},r.a.createElement(Ne.a.Item,null,r.a.createElement(S.a,{avatar:!0,src:n?n.imageUrl:null}),r.a.createElement(Ne.a.Content,null," ",r.a.createElement(Ne.a.Header,null,o)," "),r.a.createElement(Ne.a.Content,{floated:"right"},r.a.createElement(Ne.a.Description,{as:"a",onClick:function(){return i(e,t.uid)}},r.a.createElement($.a,{name:"check",color:"green"}),"Accept"),r.a.createElement(Ne.a.Description,{as:"a",onClick:function(){return s(e,t.uid)}},r.a.createElement($.a,{name:"close",color:"red"}),"Reject"))),r.a.createElement(I.a,null))}))))}}]),t}(n.Component),Le=Object(ce.d)(Object(f.b)((function(e){return{auth:e.firebase.auth,profile:e.firebase.profile,users:e.firestore.ordered.users}}),(function(e){return{acceptFriend:function(t,a){return e(J(t,a))},rejectFriend:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;var i=(0,r.getFirestore)();i.collection("users").doc(t).update({friends_pending:i.FieldValue.arrayRemove(e)}).then((function(){a({type:"REJECT_FRIEND",friend_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"REJECT_FRIEND_ERROR",err:e})}))}}(t,a))}}})),Object(ue.firestoreConnect)([{collection:"users"}]))(De),xe=a(614),ze=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).LOGIN="LOGIN",a.PROFILE="PROFILE",a.DISCOVER="DISCOVER",a.FEED="FEED",a.REQUESTS="REQUESTS",a.state={redirect_target:null,targets:{FEED:"/",LOGIN:"/login",PROFILE:"/profile/"+a.props.auth.uid,DISCOVER:"/discover",REQUESTS:"/requests"},visible:!1},a.load=function(e){a.setState({redirect_target:e,visible:!1})},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.profile,a=t?r.a.createElement(S.a,{circular:!0,centered:!0,size:"mini",src:t.imageUrl,alt:""}):null,n=t?r.a.createElement(S.a,{circular:!0,centered:!0,size:"small",src:t.imageUrl,alt:""}):null,i=t&&t.friends_pending?t.friends_pending.length:0,s=i>0?r.a.createElement(g.a.Item,{onClick:function(){e.load(e.REQUESTS)}},"Friend Requests:",r.a.createElement(ve.a,{color:"teal"},i," ")):null,o=r.a.createElement("div",{className:"fullsize_div",id:"sidebar_2"},r.a.createElement(g.a,{fixed:"top",className:"top_menu"},r.a.createElement(g.a.Item,{icon:"th list",onClick:function(){e.setState({visible:!e.state.visible})}}),r.a.createElement(g.a.Item,{header:!0,onClick:function(){e.load(e.FEED)}},"Runtime Terror"),r.a.createElement(g.a.Item,{onClick:function(){e.load(e.PROFILE)}},a),s),r.a.createElement("div",{id:"sidebar"},r.a.createElement(xe.a.Pushable,{as:X.a},r.a.createElement(xe.a,{as:g.a,animation:"slide along",direction:"left",icon:"labeled",inverted:!0,vertical:!0,visible:this.state.visible,onHide:function(){return e.setState({visible:!1})},width:"thin"},r.a.createElement(g.a.Item,{onClick:function(){e.load(e.PROFILE)},name:"Profile"},r.a.createElement("br",null),n,r.a.createElement("br",null),"Profile"),",",r.a.createElement(g.a.Item,{onClick:function(){e.load(e.DISCOVER)},icon:"map",name:"Discover"}),",",r.a.createElement(g.a.Item,{onClick:function(){e.load(e.FEED)},icon:"sitemap",name:"Feed"}),",",r.a.createElement(g.a.Item,{onClick:this.props.signOut,name:"Sign out",icon:"sign out",position:"right"})),r.a.createElement(xe.a.Pusher,{dimmed:this.state.visible},this.props.content))));if(null!=this.state.redirect_target){var l=this.state.targets[this.state.redirect_target];return r.a.createElement("div",{className:"fullsize_div"},r.a.createElement(m.a,{to:l}),o)}return o}},{key:"componentDidUpdate",value:function(){null!=this.state.redirect_target&&this.setState({redirect_target:null})}}]),t}(n.Component),Me=Object(f.b)((function(e){return{auth:e.firebase.auth,profile:e.firebase.profile}}),(function(e){return{signOut:function(){return e((function(e,t){H.auth().signOut().then((function(){e({type:"SIGNOUT_SUCCESS"})}))}))}}}))(ze),qe=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"404: Page not found"))}}]),t}(n.Component),Be=Object(h.a)(),Ge=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!0},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.auth,t=r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/",component:Ee}),r.a.createElement(m.b,{path:"/login",component:oe}),r.a.createElement(m.b,{path:"/discover",component:B}),r.a.createElement(m.b,{path:"/tokenHandler",component:Q}),r.a.createElement(m.b,{path:"/profile/:id",component:Ae}),r.a.createElement(m.b,{path:"/createpost",component:Se}),r.a.createElement(m.b,{path:"/requests",component:Le}),r.a.createElement(m.b,{component:qe})),a=e.isLoaded&&e.uid?r.a.createElement(Me,{content:t}):r.a.createElement("div",null,r.a.createElement(m.a,{to:"/"}),r.a.createElement(g.a,null,r.a.createElement(g.a.Item,{header:!0},"Runtime Terror")),r.a.createElement(oe,null));return this.state.isLoading?r.a.createElement("div",{className:"fullsize_div"}," ",r.a.createElement(E.a,{active:!0,size:"massive"},"Loading")," "):r.a.createElement(p.a,{basename:"/Mutter",history:Be},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.auth.isLoaded&&(e.auth.isEmpty||e.auth.uid)?{isLoading:!1}:null}}]),t}(n.Component),Ve=Object(f.b)((function(e){return{auth:e.firebase.auth}}))(Ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var He={authError:null},Je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(_e.a)({},e,{authError:"Login Failed!"});case"LOGIN_SUCCESS":return console.log("login success"),Object(_e.a)({},e,{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return console.log("signup success"),Object(_e.a)({},e,{authError:null});case"SIGNUP_ERROR":return console.log("signup error"),Object(_e.a)({},e,{authError:t.err.message});case"USER_IMAGE":return console.log("Updated user image",t.uId,t.imageUrl),e;case"USER_IMAGE_ERROR":return console.log("Update user image error",t.err),e;case"USER_UPDATE":return console.log("Updated user profile",t.uId,t.newInfo),e;case"USER_UPDATE_ERROR":return console.log("Update user profile error",t.err),e;case"SEND_FRIEND_REQUEST":return console.log("Sent friend request",t.profile_user_id,t.logged_in_user_id),e;case"SEND_FRIEND_REQUEST_ERROR":return console.log("Send friend request error",t.err),e;case"REMOVE_FRIEND":return console.log("Sent friend request",t.profile_user_id,t.logged_in_user_id),e;case"REMOVE_FRIEND_ERROR":return console.log("Send friend request error",t.err),e;case"ACCEPT_FRIEND":return console.log("Accepted friend request",t.friend_user_id,t.logged_in_user_id),e;case"ACCEPT_FRIEND_ERROR":return console.log("Accept friend request error",t.err),e;case"REJECT_FRIEND":return console.log("Rejected friend request",t.friend_user_id,t.logged_in_user_id),e;case"REJECT_FRIEND_ERROR":return console.log("Reject friend request error",t.err),e;case"SPOTIFY_TOKEN":return console.log("Updated user spotify token",t.uId),e;case"SPOTIFY_TOKEN_ERROR":return console.log("Update user spotify token error",t.err),e;default:return e}},We={posts:[{song:null}]},Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_POST":return console.log("Created post:",t.post),e;case"CREATE_POST_ERROR":return console.log("Create post error:",t.err),e;default:return e}},Ye=a(111),Ke=Object(ce.c)({auth:Je,post:Qe,firestore:Ye.firestoreReducer,firebase:ue.firebaseReducer}),$e=a(336),Xe=Object(ce.e)(Ke,Object(ce.d)(Object(ce.a)($e.a.withExtraArgument({getFirebase:ue.getFirebase,getFirestore:Ye.getFirestore})),Object(Ye.reduxFirestore)(H))),Ze={firebase:H,config:{useFirestoreForProfile:!0,userProfile:"users",attachAuthIsReady:!0},dispatch:Xe.dispatch,createFirestoreInstance:Ye.createFirestoreInstance};s.a.render(r.a.createElement(f.a,{store:Xe},r.a.createElement(ue.ReactReduxFirebaseProvider,Ze,r.a.createElement(Ve,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[350,1,2]]]);
//# sourceMappingURL=main.b104cd52.chunk.js.map