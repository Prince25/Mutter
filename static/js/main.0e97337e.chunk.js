(this.webpackJsonpMutter=this.webpackJsonpMutter||[]).push([[0],{354:function(e,t,a){e.exports=a(593)},359:function(e,t,a){},593:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(73),s=a.n(i),o=(a(359),a(18)),l=a(20),c=a(22),u=a(21),d=a(28),m=a(57),p=a(27),h=a(606),f=a(212),g=a.n(f),E=a(313),v=a(342),y=a(318),b=a(595),_=a(614),k=a(616),O=a(341),S=a(617),P=a(608),R=a(618),C=a(605),I=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={isOpen:!1},e.handleOpen=function(){e.setState({isOpen:!0}),e.timeout=setTimeout((function(){e.setState({isOpen:!1})}),1500)},e.handleClose=function(){e.setState({isOpen:!1}),clearTimeout(e.timeout)},e.makePost=function(){var t=e.props,a=t.title,r=t.url;e.props.history.push({pathname:"/createpost",state:{title:a,url:r}})},e}return Object(l.a)(a,[{key:"playSong",value:function(){var e=this.props,t=e._token,a=e.url,r=e.uri,n=e.deviceid,i=e.type,s=e.account_type;"premium"===s?("track"===i&&fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{authorization:"Bearer ".concat(t)},query:{device_id:n},body:JSON.stringify({uris:[r]})}),"album"!==i&&"artist"!==i&&"playlist"!==i||fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{authorization:"Bearer ".concat(t)},query:{device_id:n},body:JSON.stringify({context_uri:r})})):"free"===s&&window.open(a,"_blank noreferrer noopener")}},{key:"render",value:function(){var e=this,t=this.props,a=t.title,r=t.artist,i=t.album,s=t.art_url,o=t.type,l=t.account_type,c=t.player_connected,u="premium"!==l||c?n.a.createElement(b.a,{fluid:!0,positive:!0,onClick:function(){return e.playSong()}},"Listen!"):n.a.createElement(_.a,{trigger:n.a.createElement(b.a,{fluid:!0,basic:!0,color:"green"},"Listen!"),content:"Please launch Web Player first!",on:"click",open:this.state.isOpen,onClose:this.handleClose,onOpen:this.handleOpen,position:"bottom center"});return n.a.createElement(k.a,{centered:!0,raised:!0},n.a.createElement(k.a.Content,null,"track"===o?n.a.createElement(_.a,{content:"Create a post",position:"top center",trigger:n.a.createElement(b.a,{floated:"right",icon:"plus",onClick:this.makePost})}):null,n.a.createElement(k.a.Header,null,a),n.a.createElement(k.a.Meta,null,i+" - "+r),n.a.createElement(O.a,{src:s})),n.a.createElement(k.a.Content,{extra:!0},u))}}]),a}(r.Component),j=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.song_info;if(Array.isArray(e)){var t=e.map((function(e,t){return n.a.createElement(y.a.Column,{stretched:!0,key:t},n.a.createElement(I,{title:e.title,artist:e.artist,album:e.album,art_url:e.art_url,url:e.url,_token:e._token,uri:e.uri,deviceid:e.deviceid,type:e.type,account_type:e.account_type,player_connected:e.player_connected,history:e.history}))})),a=Array(Math.ceil(e.length/5)).fill().map((function(e,a){return n.a.createElement(y.a.Row,{key:a},t.slice(5*a,5*a+5))}));return n.a.createElement(y.a,{columns:"equal"},a)}return null}}]),a}(r.Component),F=function e(t,a,r,n,i,s,l,c,u,d,m,p){Object(o.a)(this,e),this.title=t,this.artist=a,this.album=r,this.art_url=n,this.url=i,this._token=s,this.uri=l,this.deviceid=c,this.type=u,this.account_type=d,this.player_connected=m,this.history=p},w=j,U=a(76),T=a(215),A=a.n(T);a(467),a(469);A.a.initializeApp({apiKey:"AIzaSyC3c5yOwWqL3jtVSmQqHQuHFdTjjRwvrgQ",authDomain:"mutterv2.firebaseapp.com",databaseURL:"https://mutterv2.firebaseio.com",projectId:"mutterv2",storageBucket:"mutterv2.appspot.com",messagingSenderId:"249647477019",appId:"1:249647477019:web:2c54f88c7325cc1f6723be"});var N=A.a,D=function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(t).update({friends_pending:i.FieldValue.arrayRemove(e)}),i.collection("users").doc(t).update({friends:i.FieldValue.arrayUnion(e)}),i.collection("users").doc(e).update({friends:i.FieldValue.arrayUnion(t)}).then((function(){a({type:"ACCEPT_FRIEND",friend_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"ACCEPT_FRIEND_ERROR",err:e})}))}},L=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);var r=(e=t.call(this)).getHashParams().access_token,n=new URLSearchParams(window.location.search).get("error");return e.state={token:r||"",error:n||""},e}return Object(l.a)(a,[{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,r=window.location.hash.substring(1);for(e=a.exec(r);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(r);return t}},{key:"componentDidMount",value:function(){this.state.error||this.handleToken()}},{key:"handleToken",value:function(){var e=this;this.props.auth&&!this.props.auth.isEmpty&&""!==this.state.token&&this.props.updateToken(this.props.auth.uid,this.state.token,(function(){return e.props.history.push("/discover")}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"fullsize_div"},this.state.error?n.a.createElement(R.a,{as:"h2",icon:!0,textAlign:"center"},n.a.createElement(C.a,{hidden:!0}),n.a.createElement(C.a,{hidden:!0}),n.a.createElement(C.a,{hidden:!0}),n.a.createElement(U.a,{name:"exclamation triangle"}),"An access error occured"):n.a.createElement(h.a,{active:!0,size:"massive"},"Redirecting..."))}}]),a}(r.Component);var x=Object(p.b)((function(e){return{auth:e.firebase.auth}}),(function(e){return{updateToken:function(t,a,r){return e(function(e,t,a){return function(r,n,i){i.getFirebase;(0,i.getFirestore)().collection("users").doc(e).update({spotify_token:t}).then((function(){r({type:"SPOTIFY_TOKEN",uId:e})})).catch((function(e){r({type:"SPOTIFY_TOKEN_ERROR",err:e})})),a()}}(t,a,r))}}}))(L),M=a(320),z=a.n(M),q=function(e){var t=!1;return{promise:new Promise((function(a,r){e.then((function(e){t?r({isCancelled:!0}):a(e)})),e.catch((function(e){r(t?{isCancelled:!0}:e)}))})),cancel:function(){t=!0}}},G=a(321),B=a.n(G),V=new z.a,H="https://accounts.spotify.com/authorize?client_id=3a54934c90894909959dd11243291615&redirect_uri="+encodeURIComponent("https://princes25.github.io/Mutter/tokenHandler")+"&scope="+encodeURIComponent(["user-read-private","user-read-email","user-read-playback-state","app-remote-control","user-read-recently-played","user-top-read","user-modify-playback-state","user-read-currently-playing","streaming"].join(" "))+"&response_type=token",Q=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).handleSearchChange=function(t,a){var r=a.value;e.setState({value:r}),setTimeout((function(){if(e.state.value.length<1)return e.setState({value:"",results:[]});switch(e.state.searchButton){case"songs":e.searchTracks(r),e.setState({results:e.state.searchedTracks!==[]&&e.state.searchedTracks.tracks&&e.state.searchedTracks.tracks.items?e.state.searchedTracks.tracks.items:[]});break;case"artists":e.searchArtists(r),e.setState({results:e.state.searchedArtists!==[]&&e.state.searchedArtists.artists&&e.state.searchedArtists.artists.items?e.state.searchedArtists.artists.items:[]});break;case"albums":e.searchAlbums(r),e.setState({results:e.state.searchedAlbums!==[]&&e.state.searchedAlbums.albums&&e.state.searchedAlbums.albums.items?e.state.searchedAlbums.albums.items:[]});break;case"playlists":e.searchPlaylists(r),e.setState({results:e.state.searchedPlaylists!==[]&&e.state.searchedPlaylists.playlists&&e.state.searchedPlaylists.playlists.items?e.state.searchedPlaylists.playlists.items:[]});break;default:e.setState({results:[]})}}),20)},e.onPrevClick=function(){e.state.player_connected&&e.player.previousTrack()},e.onPlayClick=function(){e.state.player_connected&&e.player.togglePlay()},e.onNextClick=function(){e.state.player_connected&&e.player.nextTrack()},e.createPost=function(){e.props.history.push({pathname:"/createpost",state:{title:e.state.trackName,url:e.state.trackUrl}})},e.state={loggedIn:!1,searchButton:"songs",searchedTracks:[],searchedArtists:[],searchedAlbums:[],searchedPlaylists:[],value:"",results:[],newReleases:[],recentlyPlayed:[],topTracks:[],_token:"",deviceId:"",error:"",trackName:void 0,trackUrl:void 0,artistName:void 0,albumName:void 0,playing:!1,position:0,duration:1,albumArt:"",player_connected:!1,account_type:"Not Logged In. Click to authenticate!",accountTypePromise:null,newReleasesPromise:null,recentSongsPromise:null,topTracksPromise:null,searchTracksPromise:null,searchArtistsPromise:null,searchAlbumsPromise:null,searchPlaylistsPromise:null,initializeOnceMounted:void 0},e}return Object(l.a)(a,[{key:"onRouteChange",value:function(e){this.state.player_connected&&this.player.disconnect()}},{key:"initialize",value:function(){if(this.state.loggedIn){clearInterval(this.initializeOnceMounted);var e=this.state._token,t=V.getAccessToken();e?V.setAccessToken(e):t&&V.setAccessToken(t),this.getAccountType(),this.getNewReleases(),this.getRecentSongs(),this.getTopTracks(),this.playerCheckInterval=null,this.props.history.listen(this.onRouteChange.bind(this))}}},{key:"componentDidMount",value:function(){var e=this;this.initializeOnceMounted=setInterval((function(){return e.initialize()}),20)}},{key:"componentWillUnmount",value:function(){for(var e=this.state,t=[e.accountTypePromise,e.newReleasesPromise,e.recentSongsPromise,e.topTracksPromise,e.searchTracksPromise,e.searchArtistsPromise,e.searchAlbumsPromise,e.searchPlaylistsPromise],a=0;a<t.length;a++)t[a]&&t[a].cancel();void 0!==this.initializeOnceMounted&&clearInterval(this.initializeOnceMounted)}},{key:"getAccountType",value:function(){var e=this,t=q(V.getMe());this.setState({accountTypePromise:t},(function(){t.promise.then((function(t){var a="premium"===t.product?"premium":"free";return e.setState({account_type:a}),t}),(function(e){console.log("Something went wrong!",e),401===e.status&&window.confirm("Token Expired! Please re-login to Spotify!")&&(window.location.href=H)}))}))}},{key:"getNewReleases",value:function(){var e=this,t=q(V.getNewReleases({limit:5,offset:0,country:"US"}));this.setState({newReleasesPromise:t},(function(){t.promise.then((function(t){return e.setState({newReleases:t.albums.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"getRecentSongs",value:function(){var e=this,t=q(V.getMyRecentlyPlayedTracks({limit:5}));this.setState({recentSongsPromise:t},(function(){t.promise.then((function(t){return e.setState({recentlyPlayed:t.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"getTopTracks",value:function(){var e=this,t=q(V.getMyTopTracks({limit:5}));this.setState({topTracksPromise:t},(function(){t.promise.then((function(t){return e.setState({topTracks:t.items}),t}),(function(e){console.log("Something went wrong!",e)}))}))}},{key:"searchTracks",value:function(e){var t=this,a=q(V.searchTracks(e));this.setState({searchTracksPromise:a}),a.promise.then((function(e){return t.setState({searchedTracks:e}),e}),(function(e){console.error(e)}))}},{key:"searchAlbums",value:function(e){var t=this,a=q(V.searchAlbums(e));this.setState({searchAlbumsPromise:a}),a.promise.then((function(e){return t.setState({searchedAlbums:e}),e}),(function(e){console.error(e)}))}},{key:"searchArtists",value:function(e){var t=this,a=q(V.searchArtists(e));this.setState({searchArtistsPromise:a}),a.promise.then((function(e){return t.setState({searchedArtists:e}),e}),(function(e){console.error(e)}))}},{key:"searchPlaylists",value:function(e){var t=this,a=q(V.searchPlaylists(e));this.setState({searchPlaylistsPromise:a}),a.promise.then((function(e){return t.setState({searchedPlaylists:e}),e}),(function(e){console.error(e)}))}},{key:"checkForPlayer",value:function(){var e=this.state._token;if(null!==window.Spotify){clearInterval(this.playerCheckInterval),this.player=new window.Spotify.Player({name:"Mutter Spotify Player",getOAuthToken:function(t){t(e)}}),this.createEventHandlers(),this.player.connect();this.setState({player_connected:!0})}}},{key:"checkForPlayer_driver",value:function(){var e=this;this.playerCheckInterval=setInterval((function(){return e.checkForPlayer()}),10)}},{key:"createEventHandlers",value:function(){var e=this;this.player.on("initialization_error",(function(e){console.error(e)})),this.player.on("authentication_error",(function(t){console.error(t),e.setState({loggedIn:!1})})),this.player.on("account_error",(function(e){console.error(e)})),this.player.on("playback_error",(function(e){console.error(e)})),this.player.on("player_state_changed",(function(t){return e.onStateChanged(t)})),this.player.on("ready",function(){var t=Object(E.a)(g.a.mark((function t(a){var r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.device_id,console.log("Let the music play on!"),e.setState({deviceId:r}),e.transferPlaybackHere();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"onStateChanged",value:function(e){if(null!==e){var t=e.track_window,a=t.current_track,r=t.position,n=t.duration,i=a.name,s="https://open.spotify.com/track/"+a.id,o=a.album.name,l=a.artists.map((function(e){return e.name})).join(", "),c=!e.paused,u=a.album.images[0].url;this.setState({position:r,duration:n,trackName:i,trackUrl:s,albumName:o,artistName:l,playing:c,albumArt:u})}}},{key:"transferPlaybackHere",value:function(){var e=this.state,t=e.deviceId,a=e._token;fetch("https://api.spotify.com/v1/me/player",{method:"PUT",headers:{authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({device_ids:[t],play:!1})})}},{key:"render",value:function(){var e,t=this,a=this.state,r=a.value,i=a.results,s=a.recentlyPlayed,o=a.topTracks,l=a.newReleases,c=a.trackName,u=a.artistName,d=a.albumName,m=a.albumArt,p=a.playing,h=a._token,f=a.deviceId,g=a.account_type,E=a.player_connected,P=this.props.history,R=[],C=[],I=[],j=[];if("undefined"!==i)for(e=0;e<Math.min(i.length,5);e++){var w=i[e].name,U="track"===i[e].type?i[e].artists[0].name:"playlist"===i[e].type?i[e].owner.display_name:"album"===i[e].type?i[e].artists[0].name:"",T="track"===i[e].type?i[e].album.name:"",A="artist"===i[e].type||"playlist"===i[e].type||"album"===i[e].type?i[e].images.length>0?i[e].images[0].url:"":i[e].album.images[0].url,N=i[e].external_urls.spotify,D=h,L=i[e].uri,x=f,M=i[e].type;R.push(new F(w,U,T,A,N,D,L,x,M,g,E,P))}if("undefined"!==s)for(e=0;e<Math.min(s.length,5);e++){var z=s[e].track.name,q=s[e].track.artists[0].name,G=s[e].track.album.name,V=s[e].track.album.images[0].url,Q=s[e].track.external_urls.spotify,W=h,Y=s[e].track.uri,K=f,$=s[e].track.type;I.push(new F(z,q,G,V,Q,W,Y,K,$,g,E,P))}if("undefined"!==o)for(e=0;e<Math.min(o.length,5);e++){var X=o[e].name,Z=o[e].artists[0].name,ee=o[e].album.name,te=o[e].album.images[0].url,ae=o[e].external_urls.spotify,re=h,ne=o[e].uri,ie=f,se=o[e].type;j.push(new F(X,Z,ee,te,ae,re,ne,ie,se,g,E,P))}if("undefined"!==l)for(e=0;e<Math.min(l.length,5);e++){var oe=l[e].name,le=l[e].artists[0].name,ce=l[e].images[0].url,ue=l[e].external_urls.spotify,de=h,me=l[e].uri,pe=f,he=l[e].type;C.push(new F(oe,le,"",ce,ue,de,me,pe,he,g,E,P))}var fe=n.a.createElement(v.a.Item,null,n.a.createElement(y.a,null,n.a.createElement(b.a,{key:0,inverted:!0,icon:"backward",onClick:this.onPrevClick}),n.a.createElement(b.a,{key:1,inverted:!0,icon:p?"pause":"play",onClick:this.onPlayClick}),n.a.createElement(b.a,{key:2,inverted:!0,icon:"forward",onClick:this.onNextClick}),n.a.createElement(_.a,{key:3,trigger:n.a.createElement(v.a.Item,null,c),position:"bottom center"},n.a.createElement(_.a.Content,null,n.a.createElement(k.a,{centered:!0,raised:!0},n.a.createElement(k.a.Content,null,n.a.createElement(k.a.Header,null,c),n.a.createElement(k.a.Meta,null,d+" - "+u),n.a.createElement(O.a,{src:m}))))),n.a.createElement(_.a,{key:4,trigger:n.a.createElement(b.a,{inverted:!0,icon:"plus",onClick:this.createPost}),position:"bottom center"},n.a.createElement(_.a.Content,null,"Create post"))));return n.a.createElement("div",{className:"Discover"},n.a.createElement(v.a,{inverted:!0},"premium"===this.state.account_type?!this.state.loggedIn||this.state.player_connected&&void 0!==c?fe:n.a.createElement(v.a.Item,{onClick:function(){return t.checkForPlayer_driver()}},"Launch Web Player"):null,n.a.createElement(v.a.Item,{position:"right",onClick:function(){return console.log()}},n.a.createElement(y.a,{centered:!0},n.a.createElement(S.a,{fluid:!0,showNoResults:!1,size:"large",onSearchChange:B.a.debounce(this.handleSearchChange,20),value:r,placeholder:"Search for "+this.state.searchButton+"..."}),n.a.createElement(b.a.Group,{labeled:!0},n.a.createElement(b.a,{positive:"songs"===this.state.searchButton,secondary:!0,content:"Song",onClick:function(){return t.setState({value:"",results:[],searchButton:"songs"})}}),n.a.createElement(b.a,{positive:"artists"===this.state.searchButton,secondary:!0,content:"Artist",onClick:function(){return t.setState({value:"",results:[],searchButton:"artists"})}}),n.a.createElement(b.a,{positive:"albums"===this.state.searchButton,secondary:!0,content:"Album",onClick:function(){return t.setState({value:"",results:[],searchButton:"albums"})}}),n.a.createElement(b.a,{positive:"playlists"===this.state.searchButton,secondary:!0,content:"Playlist",onClick:function(){return t.setState({value:"",results:[],searchButton:"playlists"})}})))),this.state.loggedIn?n.a.createElement(v.a.Item,{href:H},"Spotify Status: ",n.a.createElement("p",{style:{color:"premium"===this.state.account_type?"gold":"green",whiteSpace:"pre"}}," ",this.state.account_type.charAt(0).toUpperCase()+this.state.account_type.slice(1)," ")):n.a.createElement(v.a.Item,{href:H},"Sign In To Spotify")),this.state.loggedIn||""!==this.state._token?null:n.a.createElement("p",{align:"center",style:{color:"#139bd1",fontSize:"26px"}},"Welcome! ",n.a.createElement("br",null)," Please log into Spotify to get started."),0!==R.length?n.a.createElement(J,{title:"Search Results",song_info:R,expand:this.expandSection}):null,0!==I.length?n.a.createElement(J,{title:"Recent Songs",song_info:I}):null,0!==j.length?n.a.createElement(J,{title:"Your Top Picks",song_info:j}):null,0!==C.length?n.a.createElement(J,{title:"New Releases",song_info:C}):null,n.a.createElement("br",null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.profile.isLoaded&&e.profile.spotify_token&&t._token!==e.profile.spotify_token?{_token:e.profile.spotify_token,loggedIn:!0}:null}}]),a}(r.Component),J=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.song_info;return n.a.createElement("div",null,n.a.createElement("br",null),n.a.createElement(P.a,{fluid:!0},n.a.createElement(R.a,{as:"h2",textAlign:"center"},t),n.a.createElement(C.a,null),n.a.createElement(w,{song_info:a}),n.a.createElement(C.a,{hidden:!0}),n.a.createElement(C.a,{hidden:!0})))}}]),a}(r.Component),W=Object(p.b)((function(e){return{profile:e.firebase.profile}}))(Q),Y=a(319),K=a(317),$=a(220),X=a(67),Z=a(611),ee=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={email:"",password:"",name:""},e.submit=function(){e.props.signUp(e.state)},e.change=function(t){e.setState(Object(X.a)({},t.target.id,t.target.value))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.authError;return n.a.createElement(Z.a,{onSubmit:this.submit},n.a.createElement(Z.a.Field,null,n.a.createElement(Z.a.Input,{label:"Email",id:"email",placeholder:"Enter your email",onChange:this.change})),n.a.createElement(Z.a.Field,null,n.a.createElement(Z.a.Input,{label:"Password",id:"password",placeholder:"Enter your password",type:"password",onChange:this.change})),n.a.createElement(Z.a.Field,null,n.a.createElement(Z.a.Input,{label:"Name",id:"name",placeholder:"Enter your name",onChange:this.change})),e?n.a.createElement("p",{style:{color:"red"}},e):null,n.a.createElement(Z.a.Field,{control:b.a},n.a.createElement(K.a,null,n.a.createElement(U.a,{name:"headphones"}),"Sign Up")))}}]),a}(r.Component),te=Object(p.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signUp:function(t){return e(function(e){return function(t,a,r){var n=(0,r.getFirestore)();N.auth().createUserWithEmailAndPassword(e.email,e.password).then((function(t){n.collection("users").doc(t.user.uid).set({name:e.name,friends:[],friends_pending:[],privacy:"public",spotify_token:"",imageUrl:"https://firebasestorage.googleapis.com/v0/b/mutterv2.appspot.com/o/default.png?alt=media&token=3eace69d-a34a-4721-b55c-0d6d8fd25f2a"})})).then((function(){t({type:"SIGNUP_SUCCESS"})})).catch((function(e){t({type:"SIGNUP_ERROR",err:e})}))}}(t))}}}))(ee),ae=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={email:"",password:""},e.submit=function(){e.props.signIn(e.state)},e.change=function(t){e.setState(Object(X.a)({},t.target.id,t.target.value))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.authError;return n.a.createElement(Z.a,{onSubmit:this.submit},n.a.createElement(Z.a.Field,null,n.a.createElement(Z.a.Input,{label:"Email",id:"email",placeholder:"Enter your email",onChange:this.change})),n.a.createElement(Z.a.Field,null,n.a.createElement(Z.a.Input,{label:"Password",id:"password",placeholder:"Enter your password",type:"password",onChange:this.change})),e?n.a.createElement("p",{style:{color:"red"}},e):null,n.a.createElement(Z.a.Field,{control:b.a,fluid:!0},n.a.createElement(K.a,null,n.a.createElement(U.a,{name:"headphones"}),"Sign In")))}}]),a}(r.Component),re=Object(p.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signIn:function(t){return e((a=t,function(e,t){N.auth().signInWithEmailAndPassword(a.email,a.password).then((function(){e({type:"LOGIN_SUCCESS"})})).catch((function(t){e({type:"LOGIN_ERROR",err:t})}))}));var a}}}))(ae),ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={signing_up:!1},e.sign_up=function(t){e.setState({signing_up:t})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.signing_up?n.a.createElement(te,null):n.a.createElement(re,null);return n.a.createElement("div",null,n.a.createElement(b.a.Group,null,n.a.createElement(b.a,{color:"yellow",onClick:function(){e.sign_up(!0)}},n.a.createElement(K.a,null,n.a.createElement(U.a,{name:"plus"}),"Sign Up")),n.a.createElement(b.a.Or,null),n.a.createElement(b.a,{color:"yellow",onClick:function(){e.sign_up(!1)}},n.a.createElement(K.a,null,n.a.createElement(U.a,{name:"music"}),"Sign In"))),n.a.createElement($.a,null,t))}}]),a}(r.Component),ie=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.auth;return e.isLoaded&&e.uid?n.a.createElement(d.a,{to:"/"}):n.a.createElement(y.a,{padded:!0,centered:!0},n.a.createElement(O.a,{src:"/Mutter/img/silhouette_2.png"}),n.a.createElement(Y.a,null," ",n.a.createElement(ne,null)," "))}}]),a}(r.Component),se=Object(p.b)((function(e){return{auth:e.firebase.auth}}))(ie),oe=a(621),le=a(39),ce=a(61),ue=a(327),de=a.n(ue),me=a(613),pe=function(e){var t=e.post,a=e.users,r=a&&t?a.filter((function(e){return e.id===t.authorId}))[0]:null,i=n.a.createElement("div",null,n.a.createElement(m.b,{to:"/profile/"+t.authorId}," ",t.author," "),"rated song ",n.a.createElement("b",null,n.a.createElement("a",{href:t.url?t.url:null}," ",t.song," ")),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=1?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=2?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=3?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=4?"star_checked":"")}),n.a.createElement("span",{className:"fa fa-star "+(t.rating>=5?"star_checked":"")}));return r&&t?n.a.createElement("div",null,n.a.createElement(me.a,{size:"large"},n.a.createElement(me.a.Event,{image:r.imageUrl,date:de()(t.createdAt.toDate()).format("LLLL"),summary:i,extraText:t.comment})),n.a.createElement(C.a,null)):null},he=function(e){var t=e.posts,a=e.users;return n.a.createElement("div",null,t&&0===t.length?n.a.createElement("h3",null,"No Posts Yet!"):null,t&&t.map((function(e){return n.a.createElement(pe,{key:e.id,post:e,users:a})})))},fe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={friendsPosts:null,explorePosts:null,users:null},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=[{menuItem:"Friends",render:function(){return n.a.createElement(oe.a.Pane,null,n.a.createElement(he,{posts:e.state.friendsPosts,users:e.state.users}))}},{menuItem:"Explore",render:function(){return n.a.createElement(oe.a.Pane,null,n.a.createElement(he,{posts:e.state.explorePosts,users:e.state.users}))}}];return n.a.createElement("div",null,n.a.createElement(C.a,{hidden:!0}),n.a.createElement(oe.a,{panes:t}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={};return e.explorePosts!==t.explorePosts&&Object.assign(a,{explorePosts:e.explorePosts}),void 0!==e.friendsPosts&&e.friendsPosts!==t.friendsPosts&&Object.assign(a,{friendsPosts:e.friendsPosts}),void 0!==e.users&&e.users!==t.users&&Object.assign(a,{users:e.users}),0!==a.length?a:null}}]),a}(r.Component),ge=Object(le.d)(Object(p.b)((function(e){var t=["0"];for(var a in e.firestore.ordered.users)e.firebase.auth.uid===e.firestore.ordered.users[a].id&&(t=e.firestore.ordered.users[a].friends);if(null!=e.firestore.ordered.friendsPosts)var r=e.firestore.ordered.friendsPosts.sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds}));if(e.firestore.ordered.publicPosts)var n=e.firestore.ordered.publicPosts.sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds}));return{explorePosts:n,friendsPosts:r,auth:e.firebase.auth,users:e.firestore.ordered.users,currentFriendsList:t}})),Object(ce.firestoreConnect)((function(e){return[{collection:"users"},{collection:"posts",storeAs:"friendsPosts",where:["authorId","in",null===e.currentFriendsList||0===e.currentFriendsList.length?["0"]:e.currentFriendsList]},{collection:"posts",storeAs:"publicPosts",where:["privacy","==","public"]}]})))(fe),Ee=a(126),ve=a(612),ye=a(107),be=a(53),_e=a(609),ke=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var r;Object(o.a)(this,a),(r=t.call(this)).handleChange=function(e){r.setState(Object(X.a)({},e.target.id,e.target.value))},r.handleRating=function(e,t){var a=t.value;r.setState({rating:a})},r.handleSubmit=function(e){e.preventDefault(),r.state.rating?(r.props.createPost({song:r.state.song,comment:r.state.comment,rating:r.state.rating,privacy:r.state.privacy,url:r.state.url}),r.props.history.push("/")):r.setState({error:"Rating is required!"})},r.toggle=function(){r.setState({privacy:"private"===r.state.privacy?"public":"private"})};var n=e&&e.location?e.location.state:null;return r.state={song:n?n.title:"",comment:"",rating:"",url:n?n.url:"",privacy:e.profile.privacy,error:!1},r}return Object(l.a)(a,[{key:"render",value:function(){return n.a.createElement(P.a,{text:!0},n.a.createElement(C.a,{hidden:!0}),n.a.createElement(R.a,{as:"h2"},"Create Post"),n.a.createElement(Z.a,{onSubmit:this.handleSubmit},n.a.createElement(Z.a.Group,{widths:"equal"},n.a.createElement(Z.a.Input,{id:"song",label:"Song",name:"Song",required:!this.state.song,readOnly:!!this.state.url,placeholder:this.state.song,onChange:this.handleChange}),n.a.createElement(Z.a.Input,{id:"url",label:"URL",name:"URL",readOnly:!0,disabled:!this.state.url,placeholder:this.state.url,onChange:this.handleChange})),n.a.createElement(Z.a.Field,{control:_e.a,toggle:!0,label:"private"===this.state.privacy?"This post will be Private":"This post will be Public",defaultChecked:"private"===this.state.privacy,onClick:this.toggle}),n.a.createElement(Z.a.Dropdown,{id:"rating",label:"Rating",placeholder:"Select",required:!0,inline:!0,error:this.state.error,onChange:this.handleRating,options:[{text:"1",value:1},{text:"2",value:2},{text:"3",value:3},{text:"4",value:4},{text:"5",value:5}]}),n.a.createElement(Z.a.TextArea,{id:"comment",label:"Comment",name:"Comment",onChange:this.handleChange}),n.a.createElement(Z.a.Button,{type:"submit",color:"green"},"Create Post")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.profile&&e.profile.isLoaded&&void 0!==e.profile.privacy&&void 0===t.privacy?{privacy:e.profile.privacy}:null}}]),a}(r.Component),Oe=Object(p.b)((function(e){return{profile:e.firebase.profile}}),(function(e){return{createPost:function(t){return e((a=t,function(e,t,r){r.getFirebase;var n=(0,r.getFirestore)(),i=t().firebase.profile,s=t().firebase.auth.uid;n.collection("posts").add(Object(be.a)(Object(be.a)({},a),{},{author:i.name,authorId:s,createdAt:new Date})).then((function(){e({type:"CREATE_POST",post:a})})).catch((function(t){e({type:"CREATE_POST_ERROR",err:t})}))}));var a}}}))(ke),Se=function(e){var t=e.friends,a=e.users;return n.a.createElement("div",null,t&&0===t.length?n.a.createElement("h3",null,"No Friends Yet :("):null,t&&a&&t.map((function(e){var t=a.filter((function(t){return t.id===e}))[0],r=t?n.a.createElement(m.b,{to:"/profile/"+e}," ",t.name," "):null;return n.a.createElement(me.a,{key:e},n.a.createElement(me.a.Event,{image:t?t.imageUrl:null,summary:r}),n.a.createElement(C.a,{fitted:!0}))})))},Pe=a(219),Re=a.n(Pe),Ce=a(328),Ie=a.n(Ce),je=a(610),Fe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this)).state={image:"",isUploading:!1,progress:0,imageURL:"",open:!1},r.handleUploadStart=function(){r.setState({isUploading:!0,progress:0,imageURL:null,image:null})},r.handleProgress=function(e){return r.setState({progress:e})},r.handleUploadError=function(e){r.setState({isUploading:!1}),console.error(e)},r.handleUploadSuccess=function(e){r.setState({image:e,progress:100,isUploading:!1}),Re.a.storage().ref("profile_images").child(e).getDownloadURL().then((function(e){r.setState({imageURL:e}),r.props.updateImage(r.uId,e),r.handleModalClose()}))},r.handleModalClose=function(){r.setState({image:"",isUploading:!1,progress:0,imageURL:"",open:!1})},r.uId=e.uId,r}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.previousImageUrl;return n.a.createElement(ve.a,{trigger:n.a.createElement(O.a,{src:t,size:"medium",circular:!0,bordered:!0}),open:this.state.open,onOpen:function(){return e.setState({open:!0})},closeOnDimmerClick:!1,closeOnDocumentClick:!1,size:"small"},n.a.createElement(ve.a.Content,null,n.a.createElement(y.a,{divided:!0,stretched:!0,centered:!0},n.a.createElement(y.a.Row,{stretched:!0},n.a.createElement(y.a.Column,{stretched:!0},n.a.createElement(R.a,{as:"h2"},"Current"),n.a.createElement(O.a,{src:t,wrapped:!0,size:"medium",href:t,bordered:!0}))),n.a.createElement(y.a.Row,{stretched:!0},n.a.createElement(y.a.Column,{stretched:!0},n.a.createElement(y.a,{stretched:!0,columns:16},n.a.createElement(y.a.Row,null,n.a.createElement(y.a.Column,{width:6},n.a.createElement(Ie.a,{accept:"image/*",name:"image",filename:this.uId,storageRef:Re.a.storage().ref("profile_images"),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress})),n.a.createElement(y.a.Column,{width:10},this.state.imageURL?n.a.createElement(je.a,{percent:100,success:!0},"Uploaded"):this.state.isUploading?n.a.createElement(je.a,{percent:this.state.progress,progress:!0,color:"blue"}):null))))))),n.a.createElement(ve.a.Actions,null,n.a.createElement(b.a,{color:"red",onClick:function(){e.setState({open:!1})}},"Cancel")))}}]),a}(r.Component),we=Object(p.b)(null,(function(e){return{updateImage:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;(0,n.getFirestore)().collection("users").doc(e).update({imageUrl:t}).then((function(){a({type:"USER_IMAGE",uId:e,imageUrl:t})})).catch((function(e){a({type:"USER_IMAGE_ERROR",err:e})}))}}(t,a))}}}))(Fe),Ue=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={posts_content:null,friends_content:null,navigate:null,open:!1,name:"",privacy:null,profile:null},e.navigate=function(t){e.setState({navigate:t})},e.handleChange=function(t){e.setState(Object(X.a)({},t.target.id,t.target.value))},e.handleSubmit=function(t){e.handleSubmitPrivacy(t,e.state.privacy)},e.handleSubmitPrivacy=function(t,a){t.preventDefault(),e.props.updateProfile(e.props.auth.uid,{name:e.state.name,privacy:a,profile:e.state.profile}),e.props.history.push("/profile/"+e.props.auth.uid),e.setState({open:!1})},e.togglePrivacy=function(t){var a="private"===e.state.privacy?"public":"private";e.setState({privacy:a}),e.handleSubmitPrivacy(t,a)},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.auth,r=t.users,i=t.profile,s=t.match,o=t.curProfilePosts,l=t.currentFriendsList,c=r&&a?r.filter((function(e){return e.id===s.params.id}))[0]:null,u=c?c.imageUrl:null,m=a.uid&&s.params&&a.uid===s.params.id,p=s&&a?n.a.createElement(b.a,{onClick:function(){e.props.addFriend(s.params.id,a.uid)}},"Add Friend"):null;a&&c&&c.friends_pending&&c.friends_pending.includes(a.uid)?p=n.a.createElement(b.a,null,"Friend Request Sent"):a&&c&&c.friends.includes(a.uid)&&s?p=n.a.createElement(b.a,{onClick:function(){e.props.removeFriend(s.params.id,a.uid)}},"Remove Friend"):i&&i.friends_pending&&a&&s&&i.friends_pending.includes(s.params.id)&&(p=n.a.createElement(b.a,{onClick:function(){e.props.acceptFriend(s.params.id,a.uid)}},"Accept Friend Request"));var h=n.a.createElement("div",null," ",n.a.createElement(he,{posts:o,users:r})," "),f=c?l&&s&&s.params&&s.params.id&&l.includes(s.params.id)||a&&s&&s.params&&s.params.id&&a.uid===s.params.id?n.a.createElement("div",null," ",n.a.createElement(Se,{users:r,friends:c.friends})," "):n.a.createElement("div",null," ",n.a.createElement(Se,{users:r,friends:[]})," "):null,g=[{menuItem:"Posts",render:function(){return n.a.createElement(oe.a.Pane,null,h)}},{menuItem:"Friends",render:function(){return n.a.createElement(oe.a.Pane,null,f)}}];return"/createpost"===this.state.navigate?n.a.createElement("div",null,n.a.createElement(d.a,{to:this.state.navigate}),n.a.createElement(Oe,null)):n.a.createElement("div",null,n.a.createElement(y.a,{centered:!0,padded:"vertically"},n.a.createElement(Y.a,null,n.a.createElement($.a,null,m?n.a.createElement(we,{uId:a.uid,previousImageUrl:u}):n.a.createElement(O.a,{src:u,size:"medium",circular:!0,bordered:!0}),n.a.createElement("br",null),n.a.createElement(b.a,{as:"div",labelPosition:"left"},n.a.createElement(Ee.a,{basic:!0},c?c.name:null),m?n.a.createElement(ve.a,{trigger:n.a.createElement(b.a,{compact:!0,icon:"edit"}),open:this.state.open,onOpen:function(){return e.setState({open:!0})},closeOnDimmerClick:!1,closeOnDocumentClick:!1,size:"small"},n.a.createElement(ve.a.Content,null,n.a.createElement(Z.a,{onSubmit:this.handleSubmit},n.a.createElement(Z.a.Field,null,n.a.createElement("label",null,"New Name"),n.a.createElement(Z.a.Input,{id:"name",onChange:this.handleChange,placeholder:c?c.name:""})),n.a.createElement(b.a,{type:"submit",color:"green"},"Change name"),n.a.createElement(b.a,{floated:"right",color:"red",onClick:function(){return e.setState({open:!1})}},"Cancel")))):null),m?n.a.createElement("div",null,n.a.createElement(y.a,null,n.a.createElement(y.a.Column,{floated:"left"},n.a.createElement(b.a,{onClick:this.togglePrivacy,basic:!0,size:"small",color:"private"===this.state.privacy?"red":"green"},"private"===this.state.privacy?"Private":"Public")),n.a.createElement(y.a.Column,{floated:"right"},n.a.createElement(b.a,{floated:"right",icon:"plus",onClick:function(){e.navigate("/createpost")}})))):p)),n.a.createElement(Y.a,null," ",n.a.createElement(ye.a,{width:16}," ",n.a.createElement(oe.a,{panes:g})," ")," ")))}},{key:"componentDidUpdate",value:function(){null!=this.state.navigate&&this.navigate(null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={};return(null===t.profile||t.profile.isLoading)&&e.profile&&(void 0!==e.profile.privacy&&Object.assign(a,{privacy:e.profile.privacy,profile:e.profile}),void 0!==e.profile.name&&Object.assign(a,{name:e.profile.name})),a}}]),a}(r.Component),Te=Object(le.d)(Object(p.b)((function(e){var t=["0"];for(var a in e.firestore.ordered.users)e.firebase.auth.uid===e.firestore.ordered.users[a].id&&(t=e.firestore.ordered.users[a].friends);var r=[];return null!=e.firestore.ordered.curPrivatePosts&&null!=e.firestore.ordered.curPublicPosts?r=e.firestore.ordered.curPrivatePosts.concat(e.firestore.ordered.curPublicPosts).sort((function(e,t){return t.createdAt.seconds-e.createdAt.seconds})):null!=e.firestore.ordered.curPublicPosts?r=e.firestore.ordered.publicPosts:null!=e.firestore.ordered.curPrivatePosts&&(r=e.firestore.ordered.curPrivatePosts),{curProfilePosts:r,auth:e.firebase.auth,profile:e.firebase.profile,users:e.firestore.ordered.users,currentFriendsList:t}}),(function(e){return{addFriend:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(e).update({friends_pending:i.FieldValue.arrayUnion(t)}).then((function(){a({type:"SEND_FRIEND_REQUEST",profile_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"SEND_FRIEND_REQUEST_ERROR",err:e})}))}}(t,a))},removeFriend:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(e).update({friends:i.FieldValue.arrayRemove(t)}),i.collection("users").doc(t).update({friends:i.FieldValue.arrayRemove(e)}).then((function(){a({type:"REMOVE_FRIEND",profile_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"REMOVE_FRIEND_ERROR",err:e})}))}}(t,a))},acceptFriend:function(t,a){return e(D(t,a))},updateProfile:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)(),s=t.name,o=t.privacy;i.collection("users").doc(e).update({name:s,privacy:o}).then((function(){a({type:"USER_UPDATE",uId:e,newInfo:t})})).catch((function(e){a({type:"USER_UPDATE_ERROR",err:e})}))}}(t,a))}}})),Object(ce.firestoreConnect)((function(e){return[{collection:"users"},{collection:"posts",storeAs:"curPrivatePosts",where:[["authorId","==",e.match.params.id],["privacy","==",null===e.currentFriendsList||e.match.params.id!==e.auth.uid&&!e.currentFriendsList.includes(e.match.params.id)?"0":"private"]]},{collection:"posts",storeAs:"curPublicPosts",where:[["authorId","==",e.match.params.id],["privacy","==","public"]]}]})))(Ue),Ae=a(615),Ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.users,r=e.profile,i=e.acceptFriend,s=e.rejectFriend,o=r?r.friends_pending:null;return n.a.createElement("div",null,n.a.createElement(P.a,{text:!0},n.a.createElement(C.a,{hidden:!0}),o&&0===o.length?n.a.createElement("h3",null,"No Friends Requests"):null,o&&a&&o.map((function(e){var r=a.filter((function(t){return t.id===e}))[0],o=r?n.a.createElement(m.b,{to:"/profile/"+e}," ",r.name," "):null;return n.a.createElement(Ae.a,{divided:!0,animated:!0,relaxed:!0,verticalAlign:"middle",size:"big",key:e},n.a.createElement(Ae.a.Item,null,n.a.createElement(O.a,{avatar:!0,src:r?r.imageUrl:null}),n.a.createElement(Ae.a.Content,null," ",n.a.createElement(Ae.a.Header,null,o)," "),n.a.createElement(Ae.a.Content,{floated:"right"},n.a.createElement(Ae.a.Description,{as:"a",onClick:function(){return i(e,t.uid)}},n.a.createElement(U.a,{name:"check",color:"green"}),"Accept"),n.a.createElement(Ae.a.Description,{as:"a",onClick:function(){return s(e,t.uid)}},n.a.createElement(U.a,{name:"close",color:"red"}),"Reject"))),n.a.createElement(C.a,null))}))))}}]),a}(r.Component),De=Object(le.d)(Object(p.b)((function(e){return{auth:e.firebase.auth,profile:e.firebase.profile,users:e.firestore.ordered.users}}),(function(e){return{acceptFriend:function(t,a){return e(D(t,a))},rejectFriend:function(t,a){return e(function(e,t){return function(a,r,n){n.getFirebase;var i=(0,n.getFirestore)();i.collection("users").doc(t).update({friends_pending:i.FieldValue.arrayRemove(e)}).then((function(){a({type:"REJECT_FRIEND",friend_user_id:e,logged_in_user_id:t})})).catch((function(e){a({type:"REJECT_FRIEND_ERROR",err:e})}))}}(t,a))}}})),Object(ce.firestoreConnect)([{collection:"users"}]))(Ne),Le=a(619),xe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).LOGIN="LOGIN",e.PROFILE="PROFILE",e.DISCOVER="DISCOVER",e.FEED="FEED",e.REQUESTS="REQUESTS",e.state={redirect_target:null,targets:{FEED:"/",LOGIN:"/login",PROFILE:"/profile/"+e.props.auth.uid,DISCOVER:"/discover",REQUESTS:"/requests"},visible:!1},e.load=function(t){e.setState({redirect_target:t,visible:!1})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.profile,a=n.a.createElement(O.a,{circular:!0,centered:!0,size:"mini",src:"/Mutter/img/logo.png",alt:""}),r=t?n.a.createElement(O.a,{circular:!0,centered:!0,size:"mini",src:t.imageUrl,alt:""}):null,i=t?n.a.createElement(O.a,{circular:!0,centered:!0,size:"small",src:t.imageUrl,alt:""}):null,s=t&&t.friends_pending?t.friends_pending.length:0,o=s>0?n.a.createElement(v.a.Item,{onClick:function(){e.load(e.REQUESTS)}},"Friend Requests:",n.a.createElement(Ee.a,{color:"teal"},s," ")):null,l=n.a.createElement("div",{className:"fullsize_div",id:"sidebar_2"},n.a.createElement(v.a,{fixed:"top",className:"top_menu"},n.a.createElement(v.a.Item,{icon:"th list",onClick:function(){e.setState({visible:!e.state.visible})}}),n.a.createElement(v.a.Item,{header:!0,onClick:function(){e.load(e.FEED)}},a),n.a.createElement(v.a.Item,{onClick:function(){e.load(e.PROFILE)}},r),o),n.a.createElement("div",{id:"sidebar"},n.a.createElement(Le.a.Pushable,{as:$.a},n.a.createElement(Le.a,{as:v.a,animation:"slide along",direction:"left",icon:"labeled",inverted:!0,vertical:!0,visible:this.state.visible,onHide:function(){return e.setState({visible:!1})},width:"thin"},n.a.createElement(v.a.Item,{onClick:function(){e.load(e.PROFILE)},name:"Profile"},n.a.createElement("br",null),i,n.a.createElement("br",null),"Profile"),",",n.a.createElement(v.a.Item,{onClick:function(){e.load(e.DISCOVER)},icon:"map",name:"Discover"}),",",n.a.createElement(v.a.Item,{onClick:function(){e.load(e.FEED)},icon:"sitemap",name:"Feed"}),",",n.a.createElement(v.a.Item,{onClick:this.props.signOut,name:"Sign out",icon:"sign out",position:"right"})),n.a.createElement(Le.a.Pusher,{dimmed:this.state.visible},this.props.content))));if(null!=this.state.redirect_target){var c=this.state.targets[this.state.redirect_target];return n.a.createElement("div",{className:"fullsize_div"},n.a.createElement(d.a,{to:c}),l)}return l}},{key:"componentDidUpdate",value:function(){null!=this.state.redirect_target&&this.setState({redirect_target:null})}}]),a}(r.Component),Me=Object(p.b)((function(e){return{auth:e.firebase.auth,profile:e.firebase.profile}}),(function(e){return{signOut:function(){return e((function(e,t){N.auth().signOut().then((function(){e({type:"SIGNOUT_SUCCESS"})}))}))}}}))(xe),ze=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("h1",null,"404: Page not found"))}}]),a}(r.Component),qe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={isLoading:!0},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.auth,t=n.a.createElement(d.d,null,n.a.createElement(d.b,{exact:!0,path:"/",component:ge}),n.a.createElement(d.b,{path:"/login",component:se}),n.a.createElement(d.b,{path:"/discover",component:W}),n.a.createElement(d.b,{path:"/tokenHandler",component:x}),n.a.createElement(d.b,{path:"/profile/:id",component:Te}),n.a.createElement(d.b,{path:"/createpost",component:Oe}),n.a.createElement(d.b,{path:"/requests",component:De}),n.a.createElement(d.b,{component:ze})),a=e.isLoaded&&e.uid?n.a.createElement(Me,{content:t}):n.a.createElement("div",null,n.a.createElement(d.a,{to:"/"})," ",n.a.createElement(se,null)," ");return this.state.isLoading?n.a.createElement("div",{className:"fullsize_div"}," ",n.a.createElement(h.a,{active:!0,size:"massive"},"Loading")," "):n.a.createElement(m.a,{basename:"/Mutter"},a)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.auth.isLoaded&&(e.auth.isEmpty||e.auth.uid)?{isLoading:!1}:null}}]),a}(r.Component),Ge=Object(p.b)((function(e){return{auth:e.firebase.auth}}))(qe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Be={authError:null},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(be.a)(Object(be.a)({},e),{},{authError:"Login Failed!"});case"LOGIN_SUCCESS":return console.log("login success"),Object(be.a)(Object(be.a)({},e),{},{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return console.log("signup success"),Object(be.a)(Object(be.a)({},e),{},{authError:null});case"SIGNUP_ERROR":return console.log("signup error"),Object(be.a)(Object(be.a)({},e),{},{authError:t.err.message});case"USER_IMAGE":return console.log("Updated user image",t.uId,t.imageUrl),e;case"USER_IMAGE_ERROR":return console.log("Update user image error",t.err),e;case"USER_UPDATE":return console.log("Updated user profile",t.uId,t.newInfo),e;case"USER_UPDATE_ERROR":return console.log("Update user profile error",t.err),e;case"SEND_FRIEND_REQUEST":return console.log("Sent friend request",t.profile_user_id,t.logged_in_user_id),e;case"SEND_FRIEND_REQUEST_ERROR":return console.log("Send friend request error",t.err),e;case"REMOVE_FRIEND":return console.log("Sent friend request",t.profile_user_id,t.logged_in_user_id),e;case"REMOVE_FRIEND_ERROR":return console.log("Send friend request error",t.err),e;case"ACCEPT_FRIEND":return console.log("Accepted friend request",t.friend_user_id,t.logged_in_user_id),e;case"ACCEPT_FRIEND_ERROR":return console.log("Accept friend request error",t.err),e;case"REJECT_FRIEND":return console.log("Rejected friend request",t.friend_user_id,t.logged_in_user_id),e;case"REJECT_FRIEND_ERROR":return console.log("Reject friend request error",t.err),e;case"SPOTIFY_TOKEN":return console.log("Updated user spotify token",t.uId),e;case"SPOTIFY_TOKEN_ERROR":return console.log("Update user spotify token error",t.err),e;default:return e}},He={posts:[{song:null}]},Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_POST":return console.log("Created post:",t.post),e;case"CREATE_POST_ERROR":return console.log("Create post error:",t.err),e;default:return e}},Je=a(109),We=Object(le.c)({auth:Ve,post:Qe,firestore:Je.firestoreReducer,firebase:ce.firebaseReducer}),Ye=a(340),Ke=Object(le.e)(We,Object(le.d)(Object(le.a)(Ye.a.withExtraArgument({getFirebase:ce.getFirebase,getFirestore:Je.getFirestore})),Object(Je.reduxFirestore)(N))),$e={firebase:N,config:{useFirestoreForProfile:!0,userProfile:"users",attachAuthIsReady:!0},dispatch:Ke.dispatch,createFirestoreInstance:Je.createFirestoreInstance};s.a.render(n.a.createElement(p.a,{store:Ke},n.a.createElement(ce.ReactReduxFirebaseProvider,$e,n.a.createElement(Ge,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[354,1,2]]]);
//# sourceMappingURL=main.0e97337e.chunk.js.map